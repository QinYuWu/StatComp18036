<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="QinYu Wu" />

<meta name="date" content="2019-01-12" />

<title>Introduction to StatComp18036</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18036</h1>
<h4 class="author"><em>QinYu Wu</em></h4>
<h4 class="date"><em>2019-01-12</em></h4>



<div id="homework-1" class="section level2">
<h2>Homework 1</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Implement at least three examples of different types in the book “R for Beginners”.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1-p565.1" class="section level3">
<h3>Example 1 (P56,5.1)</h3>
<p>In this example, we choose the data set “InsectSprays” to do some simple analysis of variance(aov) so that we can know whether six Insecticides have different effects.</p>
<p>At first, some features of the data can be established as the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">count.<span class="dv">1</span>&lt;-<span class="kw">matrix</span>(InsectSprays<span class="op">$</span>count,<span class="dt">nrow=</span><span class="dv">12</span>)
mean.var&lt;-<span class="kw">rbind</span>(<span class="kw">colMeans</span>(count.<span class="dv">1</span>),<span class="kw">apply</span>(count.<span class="dv">1</span>,<span class="dv">2</span>,var))
<span class="kw">rownames</span>(mean.var)&lt;-<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;var&quot;</span>)
<span class="kw">colnames</span>(mean.var)&lt;-<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;F&quot;</span>)
mean.var</code></pre></div>
<pre><code>##             A        B        C        D   E        F
## mean 14.50000 15.33333 2.083333 4.916667 3.5 16.66667
## var  22.27273 18.24242 3.901515 6.265152 3.0 38.60606</code></pre>
<p>In order to get more stable variance and make data satisfy Normality hypothesis, we should do square root conversion of data. The results of aov is as following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aov.spray&lt;-<span class="kw">aov</span>(<span class="kw">sqrt</span>(InsectSprays<span class="op">$</span>count)<span class="op">~</span>InsectSprays<span class="op">$</span>spray)
<span class="kw">summary</span>(aov.spray)</code></pre></div>
<pre><code>##                    Df Sum Sq Mean Sq F value Pr(&gt;F)    
## InsectSprays$spray  5  88.44  17.688    44.8 &lt;2e-16 ***
## Residuals          66  26.06   0.395                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aov.spray<span class="op">$</span>coefficients</code></pre></div>
<pre><code>##         (Intercept) InsectSprays$sprayB InsectSprays$sprayC 
##           3.7606784           0.1159530          -2.5158217 
## InsectSprays$sprayD InsectSprays$sprayE InsectSprays$sprayF 
##          -1.5963245          -1.9512174           0.2579388</code></pre>
<p>As the P-value is much smaller than 0.05, it can be considered that the result is much significant.</p>
</div>
<div id="example-2-p52" class="section level3">
<h3>Example 2 (P52)</h3>
<p>This example in the book “R for beginners” mainly used some drawing function to reflect some features of the data iris. Moreover, I will show you some numerical results of the data.</p>
<p>Three species can be clearly distinguished by the figure as following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)</code></pre></div>
<pre><code>## Warning: package 'lattice' was built under R version 3.5.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)
<span class="kw">xyplot</span>(Petal.Length<span class="op">~</span>Petal.Width,<span class="dt">data=</span>iris,<span class="dt">groups=</span>Species,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;p&quot;</span>,<span class="st">&quot;smooth&quot;</span>),<span class="dt">span=</span>.<span class="dv">75</span>,<span class="dt">auto.key=</span><span class="kw">list</span>(<span class="dt">x=</span><span class="fl">0.15</span>,<span class="dt">y=</span><span class="fl">0.85</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next, we just pick two spiecies to do Multiple regression analysis. It is neccessary to define Dumb variable to replace the variable species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris<span class="op">$</span>isSetosa&lt;-<span class="kw">ifelse</span>(iris<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;setosa&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)
iris<span class="op">$</span>isVersicolor&lt;-<span class="kw">ifelse</span>(iris<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;versicolor&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)
iris_demo=iris[,<span class="op">-</span><span class="dv">5</span>]
m_iris&lt;-<span class="kw">lm</span>(Sepal.Width<span class="op">~</span>.,<span class="dt">data=</span>iris_demo)
<span class="kw">summary</span>(m_iris)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Sepal.Width ~ ., data = iris_demo)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.00102 -0.14786  0.00441  0.18544  0.69719 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.25891    0.31896   0.812   0.4183    
## Sepal.Length  0.37777    0.06557   5.761 4.87e-08 ***
## Petal.Length -0.18757    0.08349  -2.246   0.0262 *  
## Petal.Width   0.62571    0.12338   5.072 1.20e-06 ***
## isSetosa      1.39825    0.27715   5.045 1.34e-06 ***
## isVersicolor  0.23797    0.10425   2.283   0.0239 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2678 on 144 degrees of freedom
## Multiple R-squared:  0.6352, Adjusted R-squared:  0.6225 
## F-statistic: 50.14 on 5 and 144 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The results above reflect that only intercept is not significant. The coeficients about isSetosa and isVersicolor is much significant which implies there are several differences between different species.</p>
</div>
<div id="example-3-p454.5" class="section level3">
<h3>Example 3 (P45,4.5)</h3>
<p>This example tells us how to enrich a scatter plot. We will establish several scatter plots about ten pairs of random values. The latter is richer than former. Before showing the figures, ten pairs of random values are established as following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)
y&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)
<span class="kw">rbind</span>(x,y)</code></pre></div>
<pre><code>##         [,1]       [,2]      [,3]     [,4]       [,5]       [,6]      [,7]
## x  0.8080961 1.75642067 0.2247210 0.525871 -0.3069576 -0.1075839  0.343619
## y -0.3305240 0.08530246 0.8240545 1.494019  1.1046581  0.5686969 -1.923836
##         [,8]       [,9]      [,10]
## x -1.7075632  0.8691343  0.9169131
## y -0.2990462 -0.2845139 -0.2647920</code></pre>
<p>Figure 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x,y)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Figure 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x,y,<span class="dt">xlab=</span><span class="st">&quot;Ten random values&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Ten other values&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">pch=</span><span class="dv">22</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;yellow&quot;</span>,<span class="dt">bty=</span><span class="st">&quot;l&quot;</span>,<span class="dt">tcl=</span><span class="fl">0.4</span>,<span class="dt">main=</span><span class="st">&quot;How to customize a plot with R&quot;</span>,<span class="dt">las=</span><span class="dv">1</span>,<span class="dt">cex=</span><span class="fl">1.5</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Figure 3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opar &lt;-<span class="st"> </span><span class="kw">par</span>()
<span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightyellow&quot;</span>, <span class="dt">col.axis=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">2.5</span>, <span class="fl">0.25</span>))
<span class="kw">plot</span>(x, y, <span class="dt">xlab=</span><span class="st">&quot;Ten random values&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ten other values&quot;</span>,
<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;yellow&quot;</span>,
<span class="dt">bty=</span><span class="st">&quot;l&quot;</span>, <span class="dt">tcl=</span><span class="op">-</span>.<span class="dv">25</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">1.5</span>)
<span class="kw">title</span>(<span class="st">&quot;How to customize a plot with R (bis)&quot;</span>, <span class="dt">font.main=</span><span class="dv">3</span>, <span class="dt">adj=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Figure 4:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">opar &lt;-<span class="st"> </span><span class="kw">par</span>()
<span class="kw">par</span>(<span class="dt">bg=</span><span class="st">&quot;lightgray&quot;</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">0.25</span>))
<span class="kw">plot</span>(x, y, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>),
<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">rect</span>(<span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;cornsilk&quot;</span>)
<span class="kw">points</span>(x, y, <span class="dt">pch=</span><span class="dv">10</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="dv">2</span>)
<span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">tcl=</span><span class="op">-</span><span class="fl">0.2</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>)
<span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">tcl=</span><span class="op">-</span><span class="fl">0.2</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="st">&quot;How to customize a plot with R (ter)&quot;</span>,
<span class="dt">font.main=</span><span class="dv">4</span>, <span class="dt">adj=</span><span class="dv">1</span>, <span class="dt">cex.main=</span><span class="dv">1</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Ten random values&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.9</span>, <span class="dt">font=</span><span class="dv">3</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Ten other values&quot;</span>, <span class="dt">line=</span><span class="fl">0.5</span>, <span class="dt">at=</span><span class="op">-</span><span class="fl">1.8</span>, <span class="dt">cex=</span><span class="fl">0.9</span>, <span class="dt">font=</span><span class="dv">3</span>)
<span class="kw">mtext</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">line=</span><span class="fl">0.3</span>,
<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.9</span>)
<span class="kw">mtext</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">line=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">0.9</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-2" class="section level2">
<h2>Homework 2</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>A discrete random variable <span class="math inline">\(X\)</span> has probability mass function</p>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(p(x)\)</span></td>
<td>0.1</td>
<td>0.2</td>
<td>0.2</td>
<td>0.2</td>
<td>0.3</td>
</tr>
</tbody>
</table>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of <span class="math inline">\(X\)</span>. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>);p&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="kw">rep</span>(<span class="fl">0.2</span>,<span class="dv">3</span>),<span class="fl">0.3</span>)
cp&lt;-<span class="kw">cumsum</span>(p);n&lt;-<span class="dv">1000</span>;r&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)
<span class="kw">set.seed</span>(<span class="dv">211</span>)
r1&lt;-x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(n),cp)<span class="op">+</span><span class="dv">1</span>]
ct1&lt;-<span class="kw">as.vector</span>(<span class="kw">table</span>(r1))
fre1&lt;-<span class="kw">rbind</span>(x,ct1<span class="op">/</span>n);<span class="kw">rownames</span>(fre1)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;frequency&quot;</span>)
fre1</code></pre></div>
<pre><code>##            [,1]  [,2]  [,3] [,4] [,5]
## x         0.000 1.000 2.000  3.0 4.00
## frequency 0.095 0.212 0.213  0.2 0.28</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct1<span class="op">/</span><span class="kw">sum</span>(ct1)<span class="op">/</span>p</code></pre></div>
<pre><code>## [1] 0.9500000 1.0600000 1.0650000 1.0000000 0.9333333</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Inverse transform method</code></pre></div>
<p>The first one is the relative frequency table. The sencond is the ratio between the frequency and the theoretical probabilities.</p>
<p>Next, we establish the results by using the sample function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">212</span>)
r2&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),n,<span class="dt">replace=</span>T,<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="kw">rep</span>(<span class="fl">0.2</span>,<span class="dv">3</span>),<span class="fl">0.3</span>))
ct2&lt;-<span class="kw">as.vector</span>(<span class="kw">table</span>(r2))
fre2&lt;-<span class="kw">rbind</span>(x,ct2<span class="op">/</span>n);<span class="kw">rownames</span>(fre2)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;frequency&quot;</span>)
fre2</code></pre></div>
<pre><code>##            [,1]  [,2]  [,3]  [,4]  [,5]
## x         0.000 1.000 2.000 3.000 4.000
## frequency 0.111 0.196 0.206 0.191 0.296</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct2<span class="op">/</span><span class="kw">sum</span>(ct2)<span class="op">/</span>p</code></pre></div>
<pre><code>## [1] 1.1100000 0.9800000 1.0300000 0.9550000 0.9866667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#R sample function</span></code></pre></div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Write a function to generate a random sample of size n from the <span class="math inline">\(Beta(a, b)\)</span> distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the <span class="math inline">\(Beta(3,2)\)</span> distribution. Graph the histogram of the sample with the theoretical <span class="math inline">\(Beta(3,2)\)</span> density superimposed.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(Beta(3,2)\)</span> with pdf <span class="math inline">\(f(x)=12x^2(1-x),~0&lt;x&lt;1\)</span>. Let <span class="math inline">\(c=2\)</span> and <span class="math inline">\(g(x)=x,~0&lt;x&lt;1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">221</span>)
n &lt;-<span class="st"> </span><span class="dv">1000</span>;j&lt;-k&lt;-<span class="dv">0</span>;y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {
u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span>
<span class="cf">if</span> (<span class="dv">6</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x) <span class="op">&gt;</span><span class="st"> </span>u) {
<span class="co">#we accept x</span>
k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
y[k] &lt;-<span class="st"> </span>x
}
}
<span class="dv">1000</span><span class="op">/</span>j    <span class="co">#efficiency</span></code></pre></div>
<pre><code>## [1] 0.5083884</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #(experiments) for n random numbers</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y,<span class="dt">freq=</span>F,<span class="dt">main=</span><span class="st">&quot;Histogram of Beta(3,2)&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;Beta(3,2)&quot;</span>)
<span class="kw">curve</span>(<span class="dv">12</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x),<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">1</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAACsAAFUAAIsAKysAK1UAK4AAVYAAVaorAAArACsrKwArKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1P+qVQCqVSuqVYCqgFWq1ICq1NSq1P+q/9Sq///UgCvUgFXUqlXUqoDU1KrU1NTU////qlX/1ID/1Kr//6r//9T///9DmSNVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMXklEQVR4nO2da2OkthWG8Tp2Zuqm2Xiym8TO9ma2ad1OsqmxPfz/PxZdQQLEKyHBCHPeD7sDIx3BM0dX5ENRk0ZVnPsCchcBAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIDiAJ3ui+sn+f+uOTC+/tf/oswPFPh5XxTvxcdjIXXx7WM3UbfY18PFQ12/fGKJf2iv8OUjy/0Ny/y8f+e+zjkBvXwYKXiaKo7kVnzUgIqiU0q/2CO/sNeDSLxrTO0l3wd+4bfOEhMC6qnsXnq8jvyG9MdG9u31ipUAWPqf+D93zcl3D8x5+A0cu65vKL0H/Xqj3L7Uv+4X5stfSd8+fS6KqwdxC+xe//6hePdYf/nAXf2B14Ri9+WmuPip/nXPUrXFNAZK9ZtLQJIDu8edsnzx/qkttjHL3I67yS9/ZlfHEitArx/3O02zPbsAoGPj9vpK1RmekCXhd3jTnr5+qgrt6qoSFMWNXXFaA0OAvuy5f6i8V02xrdkmJSu/bD1QSgBimZ11LBqQlgLEveCp/k24vfR17cX8DLvq3RO7SgXo+rH+P8v1tfhlb8VN3vK8si7oazYNDFaxa+E3zBeFFVmsYbat/1VhOWZjm2Vx1rHUgFiJV/9R30pAqkkopVPxzwyEBKT9+vdfbrgBdl42ptfq1kwzta6XPUCsSmofOLaFWGZ3bZb35vXzn+SuHm0tUwOSZ2SLo39K8evwW9OfrXs9fdIG5J3If1tApgFnI/2817Qe1N22Zg3Wqj5qvRwKw/ZMgLpt0MsHeaH/bOu3+P2Ye9/pzyYgTvTqb78fnIBMAzYg+au/HNoWpwVkmDUBWb7CqcqqtSQgdsV/vdFNqocHPes2NtyD1K3yc2Y/pDsmbdYFqOWzMCB+/HPbGLjboAvZB/Nb0430ACB3G6Q86J6da9sZldAwK029fNzf1mZz/Hpo+CwJiF3Yd6KeiY6HF+vuxbQHXT+xm3R6EO7FpLeytvrl0BTbM3viHGX3Kq+6bPnM2kh3PehzO/6owDioaYNGG2lzHDQM6OKhGQc1xf63Nau6edWOMyu6u5WSXj5fN9+rYr/xFojPAeWw+VENhH+UGdipvzz2erGrf/AK4wJkGBgCJMpiU1F2x9+2xbZm9UyCT07FZFVcaJNdtpMzDRQnauQHm0NVr4Up7Znj897ZBC0MqBQDNTV7WkzMQeyp1vPePq5mm6yGSg9X3D/YLDraP8jp04/29+Vsyx3BYp3t0BLXzHo9jK67zLhgtgERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAKwRUdDVvabNan0Xqki8bLVHamlSYcGZHtEJAXSrzElofoJ7LFLMiWhugARasmeZnZ2q0VwZIkOicK/QX5nEyrQuQoDAIyCC0YUCSwTAg/e2WASkCLkCu7+O0HkCXLg8pOkk2CsjdxhRWoq0CMnr3EUA83QYByYGOc5zTAdQbBkQWntTaPCpqa3Q4CqhOPaheBSD7pscB1RsE1Jt72eoepyW0DkDW4RoBzbm612tUMKCUhBLfUXpA/ek7AlQkJbQCQF2jEFDSSpY7oIGhMQaUklDmgIbmDgSo1eD6hhegZISyBjS8fuEBKKEL5QhIDxmaCdh4GY4l2BRXYlo3QxQlMJfCiGN940yAZLwZdwyLYHPRRlyr8F6AkhGyrUczSgjI+ZjinIAkoogIrOkAuVfIfAGlIWRZ59Fr7urT/fTwRykBuYz6AUrlQq31NipcNd2FkgEaWSHzBJSIkNGLpYh6lArQ2BLiuQB9L/lEuE+dDNDoEqIvoDSEeoCOeQAaMXoWQGW75JVBNz++hOgNKAmhngeNSkeFnClupVK3h84DkI+O2r0ql5+lAISWECGgVmIyF3c1IdlP9230UMdQKQ2gcaP+HjS03BYqmf31cNsElHc30q+HJj6jq69LAMixQ8pdxhKA/LSIB7m2kLnLyAcQa4OUC83YBg3sPpgOKMFeBnOqcSveVDA2D9P1cKbgwvXwb54JoJLHWN51A+VONjdNI5sQnWWMHkdv9jDmYnes5tydd6oxvgnRUcaCgEoendoLkCtVNKAhIzGAogeLRhXbvR74m1WmVLFEz+bhJkSfr2cDxBpg/mKHuJX7SYDsgS/YQnY+QEk0DZD632OXpsfXbxeQzzZWj6+7x5GEWmtwph5mLjyT848tMgFUQjLNdM2NMQKQ5z7fYEDd1aVAGd08Xik73SOI0wH5boQ+IyDnW+xawU5uMiBzESgxoLhK1ljz6+Ar98sAbXOh1+C/EfpcgOC9B5oLzJQ/II8FsxBzgZlCdoqfy4OSaCKgoK30GwQUtpU+GFAUIcOaeD1lGbdDaBIg8JgnF0DVxcORz+YXf3AYulM8HFAMIaObvxVL8cs/ekaPeTIBxAeKHNDiK4rwKUYmgLQHlVEvj8sUUAShbht0jBsuhgPCj3lyASSHipG7qIIBXS4DaDqhc4+DPB7zbBqQz2OeTADJuVjs6z0DAXk9B0sCaDIhba2UjfMxcq99GCAUjGP4+CyAKt04d19BOs2cp/yeg+UAyFgtW+LZfOcx2AoAGTOwJaYaut30e8yTByC4dyzEnFcqd0ytWQBNJXQ2QP5PMWIBgQrtca3xgAI3LxRBTzESe9BZAPWuBqYKWKRPBMjVZwJpQPCZaYg5j1QrA5RMvoBCFum3CCjoKUYqQI79a0BnARQYEGhzgAKfYmwOUHi8m0TJVwKo/7cGBMjSlIBAaZKvA9C0eDdpkg8uzwEtDWhiQKA0yVcAaGpAoDTJswXU+RvJSfFukiSf8PdjywBS/zsCHhMgddYVEZoAybOR8W6SJA//A7vlAMXGu0mSfG5AEwMLFPXoEuLbATQ1sECRJpxLguTzApr8Z+GpwrnEJ58X0OTAAv238YxmWi2gqR7UC+j7VgFNCyww9Lqi8UwzAgr/K+iw5OGBBS6drytyZ1oxoGBzw+9K2TygZmZ6OTg5PSeg4Ef0EwGNBxYoOm8f3CCgrhX72bymU2So8wB6wyJAQIknq29PiSerb0+JpxrKaNaaD5D3NitkFHwf93Vs9ojk/h4UV+hqAXlMVv2MvllAeLLqZ/TtAkpklADFfU+ACFDc9wRo84DekggQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAgoJaDKDGBVBUez6uYIjKZmZecv+0wQmrZOCohHkGmiyFgH4dn5cVgwIyv7kR+kIZQOkHwopILHWAfh2WsVF3Ry6bvA0t1KB0hGHlIbh6yD8Oz80/XPIYCs7JkC+hP3b/XI1ToIzy4Og9ogO3uWVUw2AKoZsA7Cs4saEwSoU2B4F+FSpoCCY4La2fkbHp73SXag5FnFxMH0KhbeArqVZyN9VDtV/FsRK3u4/7qVbTcf6EFWdkkrLhKSVr4DxcCRtJU9yzZIVAx+hXIUcgzuR6zsdfBUw8rOX82cZpcgTVaBCBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQLKAVAptrrYT/Ira+fL6f7OftovAhnd1vXr92n2kbmVBSCxS+FoEjICzXAdd3LvT7tDj304FuxsFfviU6R8AFlvurcB8SPxtd750W6XEr41p3ICJG5aVJ3nvQigUqpNZs1WKONtnrXaQjYeqCde+QA6il1F7J75zidBi+8XExWv2XdmVUOxTSrRRju3sgDUxNyR1Yw5jKhUvAHmlUlXvsreFCWDGEW+ORcqC0DCgyrW5kp3YPes26CK17G2QTrdtxWKp687TdcMygcQrzGV3t0qmLD26N2/mYMYTtJWKB0Ea0OAWKfU3D8HJLjIKtYAalg1EQs3BIj916DgH0TfVRWqDbK39jbR1DbVBt3pTuvigTORzsM9RfRiPJWOw2ds8d1OLyZvlI+DuJeUrFMTc4uS738WfqNGRXwspHbib2UcBGWPq5/fO7+aQasAJAeRWpU1GNrCXAzLmnF9Nie1m5jNZy0CBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAEC+gPJPfW68Ubq2gAAAABJRU5ErkJggg==" /><!-- --></p>
<p>As above figure shows, the generated random sample by the acceptance-rejection method quite matches with the distribution <span class="math inline">\(Beta(3,2)\)</span>.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter <span class="math inline">\(??\)</span> has <span class="math inline">\(Gamma(r, ??)\)</span> distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(Exp(??)\)</span> distribution. That is, <span class="math inline">\((Y |?? = ??) ?? fY (y|??) = ??e^{-??y}\)</span>. Generate 1000 random observations from this mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(?? = 2\)</span>.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">231</span>)
n&lt;-<span class="dv">1000</span>;r&lt;-<span class="dv">4</span>;beta&lt;-<span class="dv">2</span>
lambda&lt;-<span class="kw">rgamma</span>(n,r,beta)
y&lt;-<span class="kw">rexp</span>(n,lambda)        ##1000 random observations
y.cut&lt;-y[y<span class="op">&lt;</span><span class="dv">4</span>]
<span class="kw">hist</span>(y.cut,<span class="dt">freq=</span>F,<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">0.2</span><span class="op">*</span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">main=</span><span class="st">&quot;Histogram of mixture&quot;</span>)
<span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x)<span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>),<span class="dv">0</span>,<span class="dv">4</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>1000 random observations are stored in the vector <span class="math inline">\(y\)</span>. As there are extremely few points bigger than 4, so that we can graph the histogram without these points. The histogram of the generated sample is shown above.</p>
</div>
<div id="homework-3" class="section level2">
<h2>Homework 3</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3, 3)\)</span> cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,\dots, 0.9\)</span>. Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(Beta(3,3)\)</span> has pdf <span class="math inline">\(f(x)=30x^2(1-x)^2,~~0&lt;x&lt;1\)</span>. Then the cdf of <span class="math inline">\(Beta(3,3)\)</span> can be represented as <span class="math inline">\(F(x)=\int_0^x 30y^2(1-y)^2dy\)</span>. By the principle of Monte Carlo estimate, <span class="math inline">\(F(x)=\mathbb{E}[30xY^2(1-Y)^2]\)</span> where <span class="math inline">\(Y\sim U(0,x)\)</span>.</p>
<p>The function computed the <span class="math inline">\(Beta(3,3)\)</span> cdf is shown as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fx&lt;-<span class="cf">function</span>(n,x) {y&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,x);<span class="kw">mean</span>(<span class="dv">30</span><span class="op">*</span>x<span class="op">*</span>y<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y)<span class="op">^</span><span class="dv">2</span>)}
pbeta33&lt;-<span class="cf">function</span>(x)  ##Beta(3,3) cdf
{n&lt;-<span class="dv">1000</span>              ##size 1000
m&lt;-<span class="dv">10</span>                 ##10 groups 
Fx.vec&lt;-<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>m,<span class="cf">function</span>(o) <span class="kw">Fx</span>(n,x))
<span class="kw">mean</span>(Fx.vec)
}</code></pre></div>
<p>Next, we show you the estimated values of <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x=0.1,0.2,\dots,0.9\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beta33.hat&lt;-<span class="kw">numeric</span>(<span class="dv">9</span>)
<span class="kw">set.seed</span>(<span class="dv">311</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)  beta33.hat[i]&lt;-<span class="kw">pbeta33</span>(i<span class="op">/</span><span class="dv">10</span>)
<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span>, <span class="kw">round</span>(beta33.hat,<span class="dv">5</span>))</code></pre></div>
<pre><code>##       [,1]    [,2]
##  [1,]  0.1 0.00868
##  [2,]  0.2 0.05846
##  [3,]  0.3 0.16091
##  [4,]  0.4 0.31584
##  [5,]  0.5 0.50076
##  [6,]  0.6 0.68478
##  [7,]  0.7 0.83762
##  [8,]  0.8 0.93495
##  [9,]  0.9 0.99380</code></pre>
<p>Then we establish the theoretical values by pbeta function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span>,<span class="kw">pbeta</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>))</code></pre></div>
<pre><code>##       [,1]    [,2]
##  [1,]  0.1 0.00856
##  [2,]  0.2 0.05792
##  [3,]  0.3 0.16308
##  [4,]  0.4 0.31744
##  [5,]  0.5 0.50000
##  [6,]  0.6 0.68256
##  [7,]  0.7 0.83692
##  [8,]  0.8 0.94208
##  [9,]  0.9 0.99144</code></pre>
<p>At last, we combine the estimated values and the theoretical values to compare them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">comp&lt;-<span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span>, <span class="kw">round</span>(beta33.hat,<span class="dv">5</span>),<span class="kw">pbeta</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>)))
<span class="kw">colnames</span>(comp)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;beta33.hat&quot;</span>,<span class="st">&quot;beta33&quot;</span>)
comp</code></pre></div>
<pre><code>##     x beta33.hat  beta33
## 1 0.1    0.00868 0.00856
## 2 0.2    0.05846 0.05792
## 3 0.3    0.16091 0.16308
## 4 0.4    0.31584 0.31744
## 5 0.5    0.50076 0.50000
## 6 0.6    0.68478 0.68256
## 7 0.7    0.83762 0.83692
## 8 0.8    0.93495 0.94208
## 9 0.9    0.99380 0.99144</code></pre>
<p>From the above sheet, the estimated value is very close to the theoretical value under different values of <span class="math inline">\(x\)</span>. Hence, we can fully consider that the Monte Carlo estimate of <span class="math inline">\(Beta(3,3)\)</span> cdf is much effective.</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>The Rayleigh density [156, (18.76)] is <span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},~~x\ge0, \sigma&gt;0\)</span>. Implement a function to generate samples from a <span class="math inline">\(Rayleigh(\sigma)\)</span> distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^`}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>In order to get Rayleigh cdf, we should compute <span class="math inline">\(F(x)=\int_0^x \frac{y}{\sigma^2}e^{-y^2/(2\sigma^2)}dy\)</span> by Monte Carlo, using antithetic vaeiables. First, the integral is equal to <span class="math inline">\(\mathbb{E}[x\frac{Y}{\sigma^2}e^{-\frac{Y^2}{2\sigma^2}}]\)</span> where <span class="math inline">\(Y\sim U(0,x)\)</span>. Moreover, it can also be reprensented as <span class="math inline">\(\mathbb{E}[x^2\frac{U}{\sigma^2}e^{-\frac{x^2U^2}{2\sigma^2}}]\)</span> where <span class="math inline">\(U\sim U(0,1)\)</span>. Define <span class="math inline">\(g(U)=x^2\frac{U}{\sigma^2}e^{-\frac{x^2U^2}{2\sigma^2}}\)</span> Then we see that <span class="math inline">\(g(U)\)</span> and <span class="math inline">\(g(1-U)\)</span> are a pair of antithetic varibles.</p>
<p>The function to compute <span class="math inline">\(F(x)\)</span> is of follows:(we assume <span class="math inline">\(\sigma=1\)</span> originally)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC.Ray &lt;-<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">sigma=</span><span class="dv">1</span>, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {
cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)
<span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span>
v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u
u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v) 
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
g &lt;-<span class="st"> </span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">*</span>u<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>
cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g)
}
cdf
}</code></pre></div>
<p>When <span class="math inline">\(x=1\)</span> which implies to compute <span class="math inline">\(F(1)\)</span>, we compare the variances between single MC experiment and antithetic variable approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span>
MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
x &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="kw">set.seed</span>(<span class="dv">321</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {
MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Ray</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)
MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Ray</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)
}
<span class="kw">print</span>(<span class="kw">sd</span>(MC1))</code></pre></div>
<pre><code>## [1] 0.00591457</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">sd</span>(MC2))</code></pre></div>
<pre><code>## [1] 0.001813136</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>((<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</code></pre></div>
<pre><code>## [1] 0.9060246</code></pre>
<p>The antithetic variable approach achieved approximately 90% reduction in variance.</p>
<p>Next, we generate samples from <span class="math inline">\(Rayleigh(\sigma=1)\)</span> by inverse transform method. Actually, the cdf of <span class="math inline">\(Rayleigh(\sigma)\)</span> has the analytical form <span class="math inline">\(F(x)=1-e^{-x^2/(2\sigma^2)}\)</span>. So that the inverse transform has form <span class="math inline">\(F^{-1}(u)=(2\sigma^2\log(\frac{1}{1-u})^{1/2}\)</span>. Then we can construct antithetic varibles <span class="math inline">\(X=F^{-1}(U)\)</span> and <span class="math inline">\(X^`=F^{-1}(1-U)\)</span> from which <span class="math inline">\(U\sim U(0,1)\)</span>.</p>
<p>The function to generate samples is of follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">IT.Ray&lt;-<span class="cf">function</span>(n,<span class="dt">sigma=</span><span class="dv">1</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>){
u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)
<span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span>
v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u
u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v) 
x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))
x
}
<span class="kw">set.seed</span>(<span class="dv">321</span>)
<span class="kw">hist</span>(<span class="kw">IT.Ray</span>(<span class="dv">10000</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">breaks =</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.5</span>),<span class="dt">freq=</span>F,<span class="dt">main=</span><span class="st">&quot;Histogram of Rayleigh(1)&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>)
<span class="kw">curve</span>(x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>),<span class="dv">0</span>,<span class="dv">4</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We plot the histogram with 10000 generated random numbers and add the density curve of <span class="math inline">\(Rayleigh(1)\)</span> in the same figure. As you see, the histogram is very close to the theoritical density.</p>
<p>At last, suppose taht <span class="math inline">\(X, X_1, X_2 \sim F^{-1}(U)\)</span> and <span class="math inline">\(X^`\sim F^{-1}(1-U)\)</span> such that <span class="math inline">\(X_1,X_2\)</span> are independent. Clearly, <span class="math inline">\(X\)</span> and <span class="math inline">\(X^`\)</span> are a pair of antithetic variables. Then we compute the percent reduction in variance of <span class="math inline">\(\frac{X+X^`}2\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span>
anti.F &lt;-<span class="st"> </span>anti.T &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
<span class="kw">set.seed</span>(<span class="dv">321</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {
anti.F[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">IT.Ray</span>(<span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">FALSE</span>))
anti.T[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">IT.Ray</span>(<span class="dv">10000</span>))
}
<span class="kw">print</span>(<span class="kw">sd</span>(anti.F))</code></pre></div>
<pre><code>## [1] 0.0066631</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">sd</span>(anti.T))</code></pre></div>
<pre><code>## [1] 0.001467875</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>((<span class="kw">var</span>(anti.F)<span class="op">-</span><span class="kw">var</span>(anti.T))<span class="op">/</span><span class="kw">var</span>(anti.F))</code></pre></div>
<pre><code>## [1] 0.9514683</code></pre>
<p>The antithetic variable approach achieved approximately 95% reduction in variance.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ??close?? to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},~~x&gt;1.
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>We show two importance functions following: <span class="math display">\[
f_1(x)=e^{1-x},~~x&gt;1;~~f_2(x)=\frac12xe^{\frac{1-x^2}{4}},~~x&gt;1.
\]</span> We can show you the figure of <span class="math inline">\(g(x)/f_1\)</span> and <span class="math inline">\(g(x)/f_2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#figure $g(x)/f(x)$</span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, .<span class="dv">1</span>))
w &lt;-<span class="st"> </span><span class="dv">2</span>
g&lt;-x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)
f1&lt;-<span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)
f2&lt;-x<span class="op">*</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">2</span>
<span class="kw">plot</span>(x, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,
<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),
<span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Obviously, cdf of <span class="math inline">\(f_1,f_2\)</span> can be calculated as following: <span class="math display">\[
F_1(x)=1-e^{1-x},~~x&gt;1;~~F_2(x)=1-e^{\frac{1-x^2}{4}},~~x&gt;1.
\]</span> Then we can generate random samples by inverse transform method. We can see that <span class="math display">\[
F_1^{-1}(u)=1-\log(1-u);~~F_2^{-1}(u)=(1-4\log(1-u))^{1/2}.
\]</span> Next, we compute the integral with two importance functions respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10000</span>     ##size 10000
theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)
g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)
}
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f1, inverse transform method  </span>
x&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)
fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)
theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)
se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f2, inverse transform method  </span>
x&lt;-(<span class="dv">1</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">^</span><span class="fl">0.5</span>
fg &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">g</span>(x) <span class="op">/</span>(x<span class="op">*</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>))
theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)
se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)
<span class="kw">rbind</span>(theta.hat,se)</code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3995707 0.3997701
## se        0.1584082 0.1475037</code></pre>
<p>As established above, we find that <span class="math inline">\(f_2\)</span> produces the smaller variance. Actually, the variances is much closer, remind the figure of <span class="math inline">\(g(x)/f_1\)</span> and <span class="math inline">\(g(x)/f_2\)</span>, we see that these two lines are similar, the line of <span class="math inline">\(g(x)/f_2\)</span> is a little bit steadier. Therefore, the varience of <span class="math inline">\(f_2\)</span> is a little smaller than the other one.</p>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx
\]</span> by importance sampling.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>From the answer in exercise 5.13, we use the importance function <span class="math inline">\(f_2\)</span> to calculate the value of this integral.</p>
<p>The estimated value and variance is of followng:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10000</span>     ##size 10000
g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)
}
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f2, inverse transform method  </span>
x&lt;-(<span class="dv">1</span><span class="op">-</span><span class="dv">4</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">^</span><span class="fl">0.5</span>
fg &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">g</span>(x) <span class="op">/</span>(x<span class="op">*</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>))
theta.hat&lt;-<span class="st"> </span><span class="kw">mean</span>(fg)
se&lt;-<span class="st"> </span><span class="kw">sd</span>(fg)
<span class="kw">c</span>(theta.hat,se)</code></pre></div>
<pre><code>## [1] 0.3995199 0.1474114</code></pre>
</div>
<div id="homework-4" class="section level2">
<h2>Homework 4</h2>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Let <span class="math inline">\(X\)</span> be a non-negative random variable with <span class="math inline">\(\mu= E[X]&lt;\infty\)</span>. For a random sample <span class="math inline">\(x_1,\dots, x_n\)</span> from the distribution of <span class="math inline">\(X\)</span>, the Gini ratio is defined by <span class="math display">\[
G=\frac{1}{2n^2\mu}\sum_{j=1}^{n}\sum_{i=1}^n|x_i-x_j|.
\]</span> The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that <span class="math inline">\(G\)</span> can be written in terms of the order statistics <span class="math inline">\(x_{(i)}\)</span> as <span class="math display">\[
G=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}.
\]</span> If the mean is unknown, let <span class="math inline">\(\hat{G}\)</span> be the statistic <span class="math inline">\(G\)</span> with <span class="math inline">\(\mu\)</span> replaced by <span class="math inline">\(\bar{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal. Repeat the procedure for the uniform distribution and <span class="math inline">\(Bernoulli(0.1)\)</span>. Also construct density histograms of the replicates in each case.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>1.Standard lognormal If <span class="math inline">\(X\)</span> is standard lognormal, then <span class="math inline">\(\log(x)\sim N(0,1)\)</span>. Thus the pdf of X is <span class="math inline">\(f(x)=\frac{1}{\sqrt{2\pi}x}e^{-\frac{(\log{x})^2}{2}}\)</span>. Actually, we can compute the theoritical expectation of <span class="math inline">\(X\)</span>, its value is <span class="math inline">\(e^{1/2}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="dv">1000</span>              <span class="co">#generate 1000 random numbers</span>
m&lt;-<span class="dv">100</span>               <span class="co">#repeat 100 times </span>
Glnorm&lt;-<span class="kw">numeric</span>(m)
v&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span>n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>
<span class="kw">set.seed</span>(<span class="dv">411</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n))
  Glnorm[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="fl">0.5</span>)))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}
lnormmean&lt;-<span class="kw">mean</span>(Glnorm)
lnormmed&lt;-<span class="kw">quantile</span>(Glnorm,<span class="fl">0.5</span>)
lnormdec&lt;-<span class="kw">quantile</span>(Glnorm,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
<span class="kw">print</span>(<span class="kw">c</span>(lnormmean,lnormmed,lnormdec))</code></pre></div>
<pre><code>##                 50%        0%       10%       20%       30%       40% 
## 0.5225479 0.5203049 0.4637161 0.4875179 0.4954685 0.5042913 0.5112711 
##       50%       60%       70%       80%       90%      100% 
## 0.5203049 0.5264718 0.5328055 0.5457844 0.5636699 0.6167493</code></pre>
<p>The mean, median and deciles are established above. Mean value is 0.523 which is much approaching to median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Glnorm,<span class="dt">freq=</span>F,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.45</span>,<span class="fl">0.65</span>),<span class="dt">main=</span><span class="st">&quot;Gini ratio of standard lognormal&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>2.Uniform distribution If <span class="math inline">\(X\sim \mathbb{U}(0,1)\)</span>, then <span class="math inline">\(E(X)=0.5\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gunif&lt;-<span class="kw">numeric</span>(m)
<span class="kw">set.seed</span>(<span class="dv">411</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">sort</span>(<span class="kw">runif</span>(n))
  Gunif[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="fl">0.5</span>))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}
unifmean&lt;-<span class="kw">mean</span>(Gunif)
unifmed&lt;-<span class="kw">quantile</span>(Gunif,<span class="fl">0.5</span>)
unifdec&lt;-<span class="kw">quantile</span>(Gunif,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
<span class="kw">print</span>(<span class="kw">c</span>(unifmean,unifmed,unifdec))</code></pre></div>
<pre><code>##                 50%        0%       10%       20%       30%       40% 
## 0.3332512 0.3326977 0.3220915 0.3261315 0.3291809 0.3305091 0.3314640 
##       50%       60%       70%       80%       90%      100% 
## 0.3326977 0.3343725 0.3366427 0.3380085 0.3406779 0.3427977</code></pre>
<p>The mean, median and deciles are established above. Mean value is 0.333 which is much approaching to median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gunif,<span class="dt">freq=</span>F,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.320</span>,<span class="fl">0.345</span>),<span class="dt">main=</span><span class="st">&quot;Gini ratio of uniform distribution&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="3" style="list-style-type: decimal">
<li>Bernoulli(0.1) First, we assume that <span class="math inline">\(X\sim Bernoulli(100,0.1)\)</span>, then <span class="math inline">\(E(X)=10\)</span>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gbinom&lt;-<span class="kw">numeric</span>(m)
<span class="kw">set.seed</span>(<span class="dv">411</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">sort</span>(<span class="kw">rbinom</span>(n,<span class="dv">100</span>,<span class="fl">0.1</span>))
  Gbinom[i]&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="fl">0.5</span>))<span class="op">*</span><span class="kw">as.numeric</span>(v<span class="op">%*%</span>x)
}
binommean&lt;-<span class="kw">mean</span>(Gbinom)
binommed&lt;-<span class="kw">quantile</span>(Gbinom,<span class="fl">0.5</span>)
binomdec&lt;-<span class="kw">quantile</span>(Gbinom,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
<span class="kw">print</span>(<span class="kw">c</span>(binommean,binommed,binomdec))</code></pre></div>
<pre><code>##               50%       0%      10%      20%      30%      40%      50% 
## 3.370480 3.363337 3.178224 3.255838 3.303912 3.323530 3.344492 3.363337 
##      60%      70%      80%      90%     100% 
## 3.397924 3.416847 3.447420 3.475381 3.585718</code></pre>
<p>The mean, median and deciles are established above. Mean value is 3.370 which is much approaching to median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(Gbinom,<span class="dt">freq=</span>F,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">3.1</span>,<span class="fl">3.6</span>),<span class="dt">main=</span><span class="st">&quot;Gini ratio of Bernoulli(100,0.1)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrAFUrKwArKysrK1UrVYArVaorgNRVAABVACtVKwBVKytVgIBVgKpVgNRVqqpVqtRVqv+AKwCAVSuAgKqAqoCAqtSA1NSA1P+qVQCqVSuqVYCqgFWq1Kqq1NSq1P+q/9Sq///UgCvUgFXUqlXUqoDU1KrU1NTU1P/U////qlX/1ID/1Kr//6r//9T///8Od2qjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJrklEQVR4nO2da2ObNhiFcZvM3tY29tKti9Ots7tLFrp2C67N//9l0xUkGzgIZAfj83xwuOmVeBDiEgFJThpJnrsAQ4eCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCAEGf3yZJ8vLmPzG4u0+un9x5BxN8dr8/okXUYh9nSXKjBtNEM3nz0Kbo1eFkjuVPnm8Xk5WaszZF2X0UOfy0P5hXjatUIDdT5GWwoK+3L1oJymT8uRq0gpJEJO3IgaBUl0Cuux7Q6zT1B93VnTrRRKrmzLqXeN0yTZqYLewKMsY64Lox4zLW59vECBL5fcg/JcnSG7RF8cZ1qobMxMad3Img/8xkiXWuIshvQuvVyqtBYuqvt8mLBx3y9Ur6kVr/NovIPfWlW3eLCWo5oyg1TjczvYFlhb95csI7mXtB9cbYLmwpHUuZCi7UT2aqKGLq1Pw6g9alN25SNW4MU/LNK+HJCjI73coXlKgtlBUzPUEmUbm3lROqBH2eya0u1ldy9ViGdzL3gjYI0jHT5Oov2ySpGiUbJGdQZb8/blLVCxIJnN2xFHT1IH/ne4KuH/J/xZRvnmQFmJtC60U2M5PS7jjuhMpdzKz1g4llwruZezHqBZn68OnG7nY6oErhDNpSeeMmVb0gk+BA0NLsBL4gu+N++eN71c45gkyWZc7uhCpBk7tie6Z6GR3eydyLUS+o3MgdBOlUUFBmtmnRBq1M5fLbILWWu/eJPRCUguxyhQpvQl0jLXIv9ie7TEXmqd6f6wSVG/kIgoz9AEHysHf1y5eFL8huxcxWM2+CJ0gX7etCDGRJoyAvhl4ntYKnFGQa6QBBG9u6dq1BpmhymohVHG7b1aBWgkIaaSSoOMzvvty2E5TZNmLesQ0yNUhuGfcQUSGoIkaWtBCk/9jDvB10lnAO81CQc6IoLgba1aDrJ7F6Mou0PBMIP4ppraKtFntbkakvyI8hfmW+uJGWMe7KE0UzWKybNw4FOZcad3kbQcXyU71ntjgPqhZk8rCDVYLcGEWDXneYdwRVXmoUlccbx4LEQfvtzJ6utj2KXX1Qu4o8D7ZnZ/qk950Tt5xQJei1ulj9+l7kra5bKwW5QTfiBP7Nn9UniqaM5TqLq+PiYtUM2v1vb7yFoLMnK/03sp7WzBi7IFEFlngpsZPWLTV2QWIfq6sbDrv37+pmjV7QdtH95pJk9IL6QkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAEAUl+zxrYZ4z8xr2y0RBe1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA2Quqf/osDmcryDxmq+j3EFYzZysoz/SD3axBtWwX+insfUFxb/4dCHrOG4yhua0nq6YadBxBR8ijNcG5pcmcghrZzF5SUCNNj6JT0CnCUVBgEAoCQYYhaO+dd33DxQwyDEH67TSd34B5GC5ekKEIyiM4GrsgrajHhejIBcnXaskXeKE3+LYMFyvIvqCTXpuV0eXNDG0m616FnqMGnUhQ8WLqOOFiBhmIoB+0nx7VJ78IQSkFVUVfl03e2R3mT1yDIoWLGWQYggYUjoICgwxA0HYxL/6n06WRPvJN+6DZkWENAlAQwL3UmKvPD3S+DvPDRQwyEEFr+f7uaf1rcQPDRQwyDEHbxVJczS95qVEXXQpay/fDU1BN9PVU/ud9u+AuVhNdnAhNVrv7fnfuxyxoOOFCBR31DuMYBB2jDBXR7Dcfzr6RPpagdYxedSMWJE+kI4aLGWQogmJ0PByxoL4H+L1wMYMMQ5C6zogYLmKQYQjqdcPsMFwfhimoFWlivzZYo/HCBaWTVa4v1i5S0FZ+7GzdcLDf3c/Vr/wq1QUKyiarVF7N1xuyZwLr66c9QYO6aX+0w/w8TxvqRm5rUC7vjFxgDZLVQwpquqNotWwXdce6EQuyNWjddNc+NedKu/vLE2TaoLTf6eKYBelTxZ69qNoV7uAWV/Mdr6EIOl24fmtMQcMUpK/F+v1fdcyC1vaL7v1um41WUGYb554P7I5VkHO37BT/mz8/Qc4V2Cn+9XyOgood6xSdFygobCkKAktREFjqLASVF0IUdMRoFBQnHAWFLUVBYKkLEBT4X40jC4ra4Wz8NYiCKIiCQBAKAkEoCAShIBCEgkAQCgJBKAgEoSAQhIJAEAoCQXou3u/i9QIEgcUBFASgIMBJBIFmYESC4FOJNYKax8cjqOg9lNV1I7psQUVH8lx1GG4f7lIE1f+DGpxkoF6tp+V4glrUoPER2AaZKlTbBo2PsApnOzlcTP2Jfh40Po4i6HkbYcQQBPWb32923+T9Fo8TlIL6zacgCuo3n4IoqN98CqKgfvPHL2hMUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEBMQan/AqvNd2HPT3vJ0+CXYbkp9D84Y7y9N6Yg+daPrFyr7SLsAXMv+V6s0OSbb2N8LE0RT5B6QUr5Gpks8Al8L/lerODc+70dwSNyG1QWMZl3KKXnJPwN10WKNMrepYgsKHV2iw6C3OT+SFjy9auk/3erNVEFZV6pggV5ybPgNSxTyE/MCEtRDEXfxcqeMZ12MadjTfgnlf0UcRqi2OdBzqGnSwG9I1fYYewgRc/XsRliC3JK1UWQt1Lha+gnj3KsjydIF86xEibIS34Q69jJ64lYg+R7hJ1+nqEF9JLvxwpNLg/zw2uk5feQl+XZSOgW9JKbkdMlr4MXqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQYECCVN9d2QOq6MTivBPs2RiOoFR3PXjxGKnnUyQGI8hYkZ0zKKgK+5XydCkE/ThTHTLlLrZd/LzQXVky3XN1M5MT5ptZrA4uzQxFkNtbajObrMTP3AgSI7J/b5bIkamem8pe6v0+6NmSoQhy22PpRj1boAWpWrPUBrPJSs01PyeoQsMSJDuGvXg0XQwnKy1oqebqieJXDZQ/x2Y4guxrYoUg1T1V/B4KsgOXJ6hopDPWoGrs2ipBqg26fnIFOW3QZQoy72JeJ+Y4pQ9apSDnKHahgvSlhjxy6/OgZe4LKs+DLlXQMKEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggD/A7mYJuIQ4HysAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="qustiion" class="section level2">
<h2>Qustiion</h2>
<p>Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma = E[G]\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>If <span class="math inline">\(X\sim lognormal(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\log(X)\sim N(\mu,\sigma^2)\)</span>. Assume that we have a random sample <span class="math inline">\(X_1,X_2,\dots,X_n\)</span> from the population <span class="math inline">\(X\)</span>. Denote <span class="math inline">\(Y_i\)</span> by <span class="math inline">\(\log(X_i)\)</span> for <span class="math inline">\(1\le i\le n\)</span>, then we can construct an approximate 95% confidence interval for <span class="math inline">\(\sigma\)</span> following: <span class="math display">\[
(\sqrt{\frac{(n-1)S^2}{\chi_{n-1}^2(0.025)}},\sqrt{\frac{(n-1)S^2}{\chi_{n-1}^2(0.975)}}),
\]</span> where <span class="math inline">\(S^2=\frac{1}{n-1}\sum_{i=1}^{n}(Y_i-\bar{Y})^2\)</span>.</p>
<p>Note that <span class="math inline">\(E(G)=2\phi(\frac{\sigma}{\sqrt{2}})-1\)</span> where <span class="math inline">\(\phi\)</span> is the distribution function of standard normal (You can find this conclusion in wikipedia). Therefore we can naturally construct an approximate 95% confidence interval for <span class="math inline">\(\gamma=E(G)\)</span> following: <span class="math display">\[
(2\phi(\frac{\sqrt{\frac{(n-1)S^2}{\chi_{n-1}^2(0.025)}}}{\sqrt{2}})-1,2\phi(\frac{\sqrt{\frac{(n-1)S^2}{\chi_{n-1}^2(0.975)}}}{\sqrt{2}})-1).
\]</span></p>
<p>We assume that <span class="math inline">\(X\)</span> obtains standard lognormal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="dv">1000</span>              <span class="co">#generate 1000 random numbers</span>
m&lt;-<span class="dv">100</span>               <span class="co">#generate 100 gini ratio every times</span>
l&lt;-<span class="dv">100</span>               <span class="co">#repeat 100 times</span>
mu&lt;-<span class="dv">0</span>
sigma&lt;-<span class="dv">1</span>
ci.sigma&lt;-<span class="cf">function</span>(x,n){<span class="co">#function to construct confident interval for sigma</span>
  s2&lt;-(<span class="dv">1</span><span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">c</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>s2<span class="op">/</span><span class="kw">qchisq</span>(<span class="fl">0.975</span>,n<span class="op">-</span><span class="dv">1</span>),(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>s2<span class="op">/</span><span class="kw">qchisq</span>(<span class="fl">0.025</span>,n<span class="op">-</span><span class="dv">1</span>))
}   
ciG&lt;-<span class="kw">cbind</span>(<span class="kw">numeric</span>(m),<span class="kw">numeric</span>((m)))
judge&lt;-<span class="kw">numeric</span>(m)          <span class="co">#judge whether true value is in ci or not</span>
power.G&lt;-<span class="kw">numeric</span>(l)
G.ture&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(sigma<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))<span class="op">-</span><span class="dv">1</span> <span class="co">#the true value of G</span>
<span class="kw">set.seed</span>(<span class="dv">412</span>)
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l){
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">rlnorm</span>(n)
  cisigma&lt;-<span class="kw">ci.sigma</span>(<span class="kw">log</span>(x),n)
  ciG[i,]&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(cisigma<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))<span class="op">-</span><span class="dv">1</span>
  judge[i]&lt;-<span class="kw">I</span>(G.ture<span class="op">&gt;</span>ciG[i,<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>G.ture<span class="op">&lt;</span>ciG[i,<span class="dv">2</span>])
}
power.G[j]&lt;-<span class="kw">mean</span>(judge)
}
<span class="kw">mean</span>(power.G)</code></pre></div>
<pre><code>## [1] 0.9524</code></pre>
<p>The coverage rate of estimation is 0.9524 which is a little bigger than 0.95.</p>
</div>
<div id="quenstion" class="section level2">
<h2>Quenstion</h2>
<p>Tests for association based on Pearson product moment correlation ??, Spearman??s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall??s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution <span class="math inline">\((X, Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
We assume <span class="math inline">\((X,Y)\sim N(\mu,\Sigma)\)</span>, where <span class="math inline">\(\mu=(0,0)^T\)</span> and <span class="math inline">\(\Sigma\)</span> is of following:
<span class="math display">\[\begin{matrix}
1 &amp; \rho\\
\rho &amp; 1
\end{matrix}\]</span>
<p>Spearman’s rank correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
n &lt;-<span class="st"> </span><span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
rho.s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.1</span>)) <span class="co">#alternatives</span>
M &lt;-<span class="st"> </span><span class="kw">length</span>(rho.s)
power.s &lt;-<span class="st"> </span><span class="kw">numeric</span>(M)
<span class="kw">set.seed</span>(<span class="dv">431</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {
rho &lt;-rho.s[i]
pvalues.s &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {
<span class="co">#simulate under alternative mu1</span>
x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,rho,rho,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))
cortest.s &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],
<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)
cortest.s<span class="op">$</span>p.value } )
power.s[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues.s<span class="op">&lt;=</span><span class="st"> </span>.<span class="dv">05</span>)
}
power.s</code></pre></div>
<pre><code>##  [1] 0.984 0.917 0.752 0.582 0.366 0.238 0.122 0.068 0.060 0.125 0.227
## [12] 0.379 0.593 0.735 0.901 0.987</code></pre>
<p>Kendall’s coefficient:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
rho.k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.1</span>)) <span class="co">#alternatives</span>
M &lt;-<span class="st"> </span><span class="kw">length</span>(rho.k)
power.k &lt;-<span class="st"> </span><span class="kw">numeric</span>(M)
<span class="kw">set.seed</span>(<span class="dv">431</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {
rho &lt;-rho.k[i]
pvalues.k &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {
<span class="co">#simulate under alternative mu1</span>
x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,rho,rho,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))
cortest.k &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],
<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)
cortest.k<span class="op">$</span>p.value } )
power.k[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues.k<span class="op">&lt;=</span><span class="st"> </span>.<span class="dv">05</span>)
}
power.k</code></pre></div>
<pre><code>##  [1] 0.982 0.908 0.741 0.577 0.359 0.227 0.125 0.064 0.055 0.113 0.217
## [12] 0.357 0.577 0.730 0.899 0.984</code></pre>
<p>Pearson’s correlation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
rho.p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.1</span>)) <span class="co">#alternatives</span>
M &lt;-<span class="st"> </span><span class="kw">length</span>(rho.p)
power.p &lt;-<span class="st"> </span><span class="kw">numeric</span>(M)
<span class="kw">set.seed</span>(<span class="dv">431</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {
rho &lt;-rho.p[i]
pvalues.p &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {
<span class="co">#simulate under alternative mu1</span>
x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,rho,rho,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))
cortest.p &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],
<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
cortest.p<span class="op">$</span>p.value } )
power.p[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues.p<span class="op">&lt;=</span><span class="st"> </span>.<span class="dv">05</span>)
}
power.p</code></pre></div>
<pre><code>##  [1] 0.996 0.947 0.829 0.662 0.417 0.265 0.127 0.074 0.072 0.136 0.256
## [12] 0.417 0.661 0.815 0.953 0.992</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power.rho&lt;-<span class="kw">rbind</span>(power.s,power.k,power.p)
<span class="kw">colnames</span>(power.rho)&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.1</span>))
power.rho</code></pre></div>
<pre><code>##          -0.8  -0.7  -0.6  -0.5  -0.4  -0.3  -0.2  -0.1   0.1   0.2   0.3
## power.s 0.984 0.917 0.752 0.582 0.366 0.238 0.122 0.068 0.060 0.125 0.227
## power.k 0.982 0.908 0.741 0.577 0.359 0.227 0.125 0.064 0.055 0.113 0.217
## power.p 0.996 0.947 0.829 0.662 0.417 0.265 0.127 0.074 0.072 0.136 0.256
##           0.4   0.5   0.6   0.7   0.8
## power.s 0.379 0.593 0.735 0.901 0.987
## power.k 0.357 0.577 0.730 0.899 0.984
## power.p 0.417 0.661 0.815 0.953 0.992</code></pre>
<p>As you see, the nonparametric tests based on <span class="math inline">\(??_s\)</span> or <span class="math inline">\(??\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal.</p>
<p>Pearson’s correlation measures linear trend between two datas, it also bases on normality assumption. When the bivariate distribution <span class="math inline">\((X,Y)\)</span> is not bivariate normal, Pearson’s correlation is less significant.</p>
<p>Now, we assume that <span class="math inline">\(X\sim t_{2}\)</span>, <span class="math inline">\(Y\sim U(-1,0)\)</span> when <span class="math inline">\(X&lt;0\)</span> and <span class="math inline">\(Y\sim U(0,1)\)</span> when <span class="math inline">\(X\ge0\)</span>. Clearly, <span class="math inline">\(X,Y\)</span> are dependent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">431</span>)
pvalues.s1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {
<span class="co">#simulate under alternative mu1</span>
x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,<span class="dv">2</span>)
y&lt;-<span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  <span class="cf">if</span>(x[i]<span class="op">&lt;</span><span class="dv">0</span>) y[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)
  <span class="cf">else</span>       y[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)
}
cortest.s1 &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,
<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)
cortest.s1<span class="op">$</span>p.value } )
power.s1 &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues.s1<span class="op">&lt;=</span><span class="st"> </span>.<span class="dv">05</span>)
power.s1</code></pre></div>
<pre><code>## [1] 0.987</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">431</span>)
pvalues.p1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {
<span class="co">#simulate under alternative mu1</span>
x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,<span class="dv">2</span>)
y&lt;-<span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  <span class="cf">if</span>(x[i]<span class="op">&lt;</span><span class="dv">0</span>) y[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>)
  <span class="cf">else</span>       y[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)
}
cortest.p1 &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,
<span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
cortest.p1<span class="op">$</span>p.value } )
power.p1 &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues.p1<span class="op">&lt;=</span><span class="st"> </span>.<span class="dv">05</span>)
power.p1</code></pre></div>
<pre><code>## [1] 0.849</code></pre>
<p>In this case, the empirical power of the nonparametric test Spearman’s rank correlation coefficient <span class="math inline">\(\rho_s\)</span> is 0.987, which is bigger than the empirical power of Pearson correlation <span class="math inline">\(\rho=0.849\)</span>.</p>
</div>
<div id="homework-5" class="section level2">
<h2>Homework 5</h2>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#jackknife</span>
<span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span></code></pre></div>
<pre><code>## Warning: package 'bootstrap' was built under R version 3.5.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">cor</span>(law<span class="op">$</span>LSAT,law<span class="op">$</span>GPA)) </code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">cor</span>(law82<span class="op">$</span>LSAT,law82<span class="op">$</span>GPA))</code></pre></div>
<pre><code>## [1] 0.7599979</code></pre>
<p>The sample correlation is R = 0.7763745. The correlation for the universe of 82 law schools is R = 0.7599979. Use jackknife to estimate the bias and standard error of the correlation statistic computed from the sample of scores in law.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estimate of bias by jackknife</span>
n&lt;-<span class="kw">nrow</span>(law)
R&lt;-<span class="kw">numeric</span>(<span class="kw">nrow</span>(law))
R.hat&lt;-<span class="kw">cor</span>(law<span class="op">$</span>LSAT,law<span class="op">$</span>GPA)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)  R[i]&lt;-<span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i],law<span class="op">$</span>GPA[<span class="op">-</span>i])

bias.j&lt;-(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(R)<span class="op">-</span>R.hat)
<span class="kw">print</span>(bias.j)</code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<p>The estimate of bias is -0.006473623.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#estimate of standard error by jackknife</span>
se.j&lt;-<span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((R<span class="op">-</span><span class="kw">mean</span>(R))<span class="op">^</span><span class="dv">2</span>))
se.j</code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<p>The estimate of standard error is 0.1425186.</p>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)</code></pre></div>
<pre><code>## 
## Attaching package: 'boot'</code></pre>
<pre><code>## The following object is masked from 'package:lattice':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">521</span>)
boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])  <span class="co">#use MLE estimate </span>
boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit[,<span class="dv">1</span>], <span class="dt">statistic=</span>boot.mean, <span class="dt">R =</span> <span class="dv">2000</span>)
ci&lt;-<span class="st"> </span><span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))
ci</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.7, 181.2 )   ( 24.4, 169.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.1, 191.7 )   ( 55.4, 220.5 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(aircondit[,<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
<p>These four confidence intervals of the mean time between failures are established above, respectively. Although the four CIs all cover the value 108.0833 which is the mean time of potential data, they are quite different. As you see, bca CI is the biggest, while basic CI is the smallest. According to the fomulation of bca and percentile CI and compute some relevant quantiles, it is trival to see that the upper and lower bounds of bca CI is bigger than percentile CI. The normal CI is a litter different with percentile CI. To see it, we plot the histogram of mean time computed with generated samples (figure1). We find the distribution of mean time computed with generated samples is a little different with normal distribution. So that they are different. When the data is much close to normal, norm and percentile CI is almost same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">521</span>)
mu&lt;-<span class="kw">mean</span>(boot.obj<span class="op">$</span>t)
sigma&lt;-<span class="kw">sd</span>(boot.obj<span class="op">$</span>t)
figure1&lt;-boot.obj<span class="op">$</span>t
f&lt;-<span class="cf">function</span>(x) (<span class="dv">1</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>sigma))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">-</span>mu)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))
<span class="kw">hist</span>(figure1,<span class="dt">freq=</span>F,<span class="dt">main=</span><span class="st">&quot;Histogram of mean time&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.012</span>))
<span class="co">#histogram of mean time computed with generated samples</span>
<span class="kw">curve</span>(f,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
Rmtr.hat&lt;-<span class="kw">cov</span>(scor)
egvals.hat&lt;-<span class="kw">eigen</span>(Rmtr.hat)<span class="op">$</span>values  <span class="co">#eigen values of                                             potential data</span>
theta.hat&lt;-egvals.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(egvals.hat)

J&lt;-<span class="kw">nrow</span>(scor)
theta.star&lt;-<span class="kw">numeric</span>(J)

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J){
  Rmtr&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])
  egvals&lt;-<span class="kw">eigen</span>(Rmtr)<span class="op">$</span>values
  theta.star[i]&lt;-egvals[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(egvals)
}
bias.j&lt;-(J<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.star)<span class="op">-</span>theta.hat)
se.j&lt;-<span class="kw">sqrt</span>((J<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.star<span class="op">-</span><span class="kw">mean</span>(theta.star))<span class="op">^</span><span class="dv">2</span>))
<span class="kw">print</span>(<span class="kw">c</span>(bias.j,se.j))</code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
<p>The bias is 0.001069139, and the standard error is 0.049552307.</p>
</div>
<div id="question-12" class="section level2">
<h2>Question</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)</code></pre></div>
<pre><code>## Warning: package 'DAAG' was built under R version 3.5.2</code></pre>
<pre><code>## 
## Attaching package: 'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">magnetic&lt;-ironslag<span class="op">$</span>magnetic
chemical&lt;-ironslag<span class="op">$</span>chemical
l&lt;-<span class="kw">nrow</span>(ironslag)
n&lt;-<span class="kw">floor</span>(l<span class="op">/</span><span class="dv">2</span>)
e1&lt;-e2&lt;-e3&lt;-e4&lt;-<span class="kw">numeric</span>(<span class="dv">2</span><span class="op">*</span>n)
<span class="kw">set.seed</span>(<span class="dv">541</span>)
a&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>l,<span class="dt">replace =</span> F)      <span class="co">#disorder the potential data</span>
magnetic&lt;-magnetic[a]
chemical&lt;-chemical[a]

<span class="co"># for n-fold cross validation</span>
<span class="co"># fit models on leave-two-out samples</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>i)]
x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>i)]
J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
yhat1.<span class="dv">1</span> &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>]
yhat1.<span class="dv">2</span> &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i]
e1[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat1.<span class="dv">1</span>
e1[<span class="dv">2</span><span class="op">*</span>i] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i] <span class="op">-</span><span class="st"> </span>yhat1.<span class="dv">2</span>

J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
yhat2.<span class="dv">1</span> &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span>
J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>
yhat2.<span class="dv">2</span> &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i] <span class="op">+</span>
J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i]<span class="op">^</span><span class="dv">2</span>
e2[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat2.<span class="dv">1</span>
e2[<span class="dv">2</span><span class="op">*</span>i] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i] <span class="op">-</span><span class="st"> </span>yhat2.<span class="dv">2</span>

J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
logyhat3.<span class="dv">1</span> &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>]
logyhat3.<span class="dv">2</span> &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="dv">2</span><span class="op">*</span>i]
yhat3.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3.<span class="dv">1</span>)
yhat3.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3.<span class="dv">2</span>)
e3[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat3.<span class="dv">1</span>
e3[<span class="dv">2</span><span class="op">*</span>i] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i] <span class="op">-</span><span class="st"> </span>yhat3.<span class="dv">2</span>

J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
logyhat4.<span class="dv">1</span> &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>])
logyhat4.<span class="dv">2</span> &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="dv">2</span><span class="op">*</span>i])
yhat4.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4.<span class="dv">1</span>)
yhat4.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4.<span class="dv">2</span>)
e4[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>yhat4.<span class="dv">1</span>
e4[<span class="dv">2</span><span class="op">*</span>i] &lt;-<span class="st"> </span>magnetic[<span class="dv">2</span><span class="op">*</span>i] <span class="op">-</span><span class="st"> </span>yhat4.<span class="dv">2</span>
}

<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 19.11203 17.59112 18.16437 20.14312</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">J2</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    23.93750     -1.34026      0.05345</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math inline">\(\hat{Y} = 23.93750??? 1.34026X + 0.05345X^2.\)</span></p>
<p>Some of the residual plots for Model 2 are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(J2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-6" class="section level2">
<h2>Homework 6</h2>
</div>
<div id="question-13" class="section level2">
<h2>Question</h2>
<p>Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>We implement the two-sample Cramer-von Mises test for equal distributions as following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvm.d&lt;-<span class="cf">function</span>(x,y){ <span class="co">#compute the Cramer-von Mises statistic</span>
  n&lt;-<span class="kw">length</span>(x);m&lt;-<span class="kw">length</span>(y)
  Fn&lt;-<span class="kw">ecdf</span>(x);Gm&lt;-<span class="kw">ecdf</span>(y)
  W2&lt;-((m<span class="op">*</span>n)<span class="op">/</span>(m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>
<span class="st">      </span>(<span class="kw">sum</span>((<span class="kw">Fn</span>(x)<span class="op">-</span><span class="kw">Gm</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">Fn</span>(y)<span class="op">-</span><span class="kw">Gm</span>(y))<span class="op">^</span><span class="dv">2</span>))
  W2
}</code></pre></div>
<p>Next, we apply the test to the data in Examples 8.1 and 8.2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">attach</span>(chickwts)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)

<span class="kw">set.seed</span>(<span class="dv">611</span>)
R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span>
z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span>
n&lt;-<span class="kw">length</span>(x)
m&lt;-<span class="kw">length</span>(y)
N &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(m<span class="op">+</span>n)
reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span>
W2 &lt;-<span class="st"> </span><span class="kw">cvm.d</span>(x, y)
W2</code></pre></div>
<pre><code>## [1] 0.1515216</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {
<span class="co">#generate indices k for the first sample</span>
k &lt;-<span class="st"> </span><span class="kw">sample</span>(N, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
x1 &lt;-<span class="st"> </span>z[k]
y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span>
reps[i] &lt;-<span class="st"> </span><span class="kw">cvm.d</span>(x1, y1)
}
p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(W2, reps) <span class="op">&gt;=</span><span class="st"> </span>W2)
p</code></pre></div>
<pre><code>## [1] 0.394</code></pre>
<p>The observed Cramer-von Mises statistic is <span class="math inline">\(W_2 = 0.1515236\)</span>. The aproximate ASL 0.394 implies that there is no enough evidence to reject the null hypothesis.</p>
</div>
<div id="question-14" class="section level2">
<h2>Question</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
</ol>
<p>Note: The parameters should be choosen such that the powers are distinguishable (say, range from 0.3 to 0.9).</p>
</div>
<div id="anwer" class="section level2">
<h2>Anwer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(energy)
<span class="kw">library</span>(RANN)
<span class="kw">library</span>(Ball)</code></pre></div>
<pre><code>## Warning: package 'Ball' was built under R version 3.5.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">100</span>
k&lt;-<span class="dv">3</span>
p&lt;-<span class="dv">2</span>              <span class="co">#p-dimension Multivarziate</span>
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>    <span class="co">#size of samples </span>
R&lt;-<span class="dv">999</span>            ##number of replicates
n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2)

Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
z &lt;-<span class="st"> </span>z[ix, ];
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){         <span class="co">#NN test</span>
boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,
<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
<span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)                </code></pre></div>
<p>We will establish the powers with three methods in the following different situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>Suppose that <span class="math inline">\(X\sim N((0,0),I)\)</span> and <span class="math inline">\(Y\sim N((0,0),(1,0,0,0.25))\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">621</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span><span class="fl">0.5</span>));
z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>                <span class="co">#confidence level </span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.62 0.45 0.70</code></pre>
<p>NN, energy and Ball methods have powers 0.62, 0.45 and 0.7 respectively.</p>
<p>(2)Equal variances and unequal expectations</p>
<p>Suppose that <span class="math inline">\(X\sim N((0,0),I)\)</span> and <span class="math inline">\(Y\sim N((0,0.6),I)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">623</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="fl">0.6</span>));
z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>                <span class="co">#confidence level </span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.39 0.83 0.76</code></pre>
<p>NN, energy and Ball methods have powers 0.38, 0.85 and 0.76 respectively.</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>Suppose that <span class="math inline">\(X=(X_1,X_2), Y=(Y_1,Y_2)\)</span> where <span class="math inline">\(X_1\sim t_1, X_2\sim 0.5N(0,1)+0.5N(1,1)\)</span>. <span class="math inline">\(Y_1\sim t_1, Y_2\sim 0.5N(1,1)+0.5N(2,1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">623</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
x &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n1,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2, <span class="dt">mean =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">size =</span> n2, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">replace =</span> T), <span class="dt">sd =</span><span class="dv">1</span> ))

y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dv">1</span>),<span class="kw">rnorm</span>(n2, <span class="dt">mean =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">size =</span> n2, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">replace =</span> T), <span class="dt">sd =</span><span class="dv">1</span> ))

z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>                <span class="co">#confidence level </span>
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.63 0.73 0.73</code></pre>
<p>NN, energy and Ball methods have powers 0.68, 0.64 and 0.71 respectively.</p>
</div>
<div id="question-15" class="section level2">
<h2>Question</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a <span class="math inline">\(Cauchy(\theta, \eta)\)</span> distribution has density function <span class="math display">\[
f(x) =\frac{1}
{\theta\pi(1 + [(x- \eta)/\theta]^2)}, - \infty &lt; x &lt; \infty, \theta&gt;0.
\]</span> The standard Cauchy has the <span class="math inline">\(Cauchy(\theta= 1, \eta = 0)\)</span> density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>We choose normal distribution as the proposal distribution. Denote by <span class="math inline">\(g(??|X)\)</span> the the density function of <span class="math inline">\(\mathbb{U}(X-1,X+1)\)</span>. The initial value <span class="math inline">\(X_0\)</span> is generated from <span class="math inline">\(\mathbb{U}(-1,1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f&lt;-<span class="cf">function</span>(x) <span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))  <span class="co">#density function of standard  Cauchy distribution </span>
<span class="kw">set.seed</span>(<span class="dv">631</span>)
m &lt;-<span class="st"> </span><span class="dv">20000</span>                     <span class="co">#length of the chain</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)
k &lt;-<span class="st"> </span><span class="dv">0</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
y &lt;-<span class="st"> </span>xt<span class="op">+</span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)
num &lt;-<span class="st"> </span><span class="kw">f</span>(y) <span class="co">#* dnorm(xt, mean = y,sd=0.5)</span>
den &lt;-<span class="st"> </span><span class="kw">f</span>(xt) <span class="co">#* dnorm(y, mean = xt,sd=0.5)</span>
<span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
x[i] &lt;-<span class="st"> </span>xt
k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span>
}
}
<span class="kw">print</span>(k)           <span class="co">#the number of rejected candidate points</span></code></pre></div>
<pre><code>## [1] 3042</code></pre>
<p>In this method with the proposal distribution we selected, approximately 15% of the candidate points are rejected which implies that the chain is not effective enough but is okay.</p>
<p>Next, we give the comparision between the deciles of the generated observations and the deciles of the standard Cauchy distribution. Moreover, we will establish the qqplot and histogram of the generated observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gob&lt;-<span class="st"> </span><span class="kw">quantile</span>(x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)],<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))
stc&lt;-<span class="kw">qt</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">1</span>)
<span class="kw">rbind</span>(gob,stc)</code></pre></div>
<pre><code>##           10%       20%        30%        40%         50%       60%
## gob -3.031452 -1.522751 -0.8286663 -0.3672793 -0.01566048 0.3335357
## stc -3.077684 -1.376382 -0.7265425 -0.3249197  0.00000000 0.3249197
##           70%      80%      90%
## gob 0.7374157 1.437514 3.264603
## stc 0.7265425 1.376382 3.077684</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span><span class="dv">1001</span> <span class="co">#discard the burnin sample</span>
y &lt;-<span class="st"> </span>x[b<span class="op">:</span>m]
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.01</span>)
QR &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(a) <span class="co">#quantiles of Rayleigh</span>
Q &lt;-<span class="st"> </span><span class="kw">quantile</span>(y, a)
<span class="kw">qqplot</span>(QR, Q, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,
<span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">lines</span>(QR, <span class="kw">f</span>(QR))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The deciles between the generated observations and the deciles of the standard Cauchy distribution are much closer. Besides, as the qqplot and histogram shown above, the generated sample is much approximate with standard Cauchy distribution.</p>
</div>
<div id="question-16" class="section level2">
<h2>Question</h2>
<p>Rao <span class="math inline">\([220, Sec. 5g]\)</span> presented an example on genetic linkage of 197 animals in four categories (also discussed in <span class="math inline">\([67, 106, 171, 266])\)</span>. The group sizes are <span class="math inline">\((125, 18, 20, 34)\)</span>. Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[
(\frac12+\frac{\theta}{4},\frac{1-\theta}4,\frac{1-\theta}4,\frac{\theta}4).
\]</span> Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>We use the random walk Metropolis sampler with a uniform proposal distribution to generate the posterior distribution of <span class="math inline">\(\theta\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span><span class="fl">0.25</span>     <span class="co">#width of the uniform support set</span>
m &lt;-<span class="st"> </span><span class="dv">10000</span>    <span class="co">#length of the chain</span>
burn &lt;-<span class="st"> </span><span class="dv">1000</span>  <span class="co">#burn-in time</span>
N &lt;-<span class="st"> </span><span class="dv">197</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the chain</span>

<span class="kw">set.seed</span>(<span class="dv">641</span>)
grpsize&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">34</span>)   <span class="co">#group sizes </span>

prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, grpsize) {
<span class="co"># computes (without the constant) the target density</span>
<span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)
<span class="kw">return</span> (<span class="dv">0</span>)
<span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">1</span>] <span class="op">*</span>
((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">3</span>] <span class="op">*</span>
(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">4</span>])
}

u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)        <span class="co">#for accept/reject step</span>
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="op">-</span>w, w) <span class="co">#proposal distribution</span>
x[<span class="dv">1</span>] &lt;-<span class="fl">0.5</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i]
<span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, grpsize) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], grpsize))
x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span>
x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}

xtheta&lt;-x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>burn)]
theta.hat&lt;-<span class="kw">mean</span>(xtheta)
<span class="kw">round</span>(theta.hat,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.623</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="fl">0.5</span><span class="op">+</span>theta.hat<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta.hat)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta.hat)<span class="op">/</span><span class="dv">4</span>,theta.hat<span class="op">/</span><span class="dv">4</span>),<span class="dv">3</span>))                 </code></pre></div>
<pre><code>## [1] 0.656 0.094 0.094 0.156</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">34</span>)<span class="op">/</span>N,<span class="dv">3</span>))   </code></pre></div>
<pre><code>## [1] 0.635 0.102 0.091 0.173</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(xtheta,<span class="dt">freq=</span>F,<span class="dt">main=</span><span class="st">&quot;Histogram of theta&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;theta&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrKwArKysrK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVgIBVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1NSA1P+qVQCqVSuqVYCqgFWq1ICq1NSq1P+q/6qq/9Sq///UgCvUgFXUqlXUqoDU1KrU1NTU/6rU////qlX/1ID/1Kr//6r//9T/////TR5xAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJeElEQVR4nO2dC3ubNhhGcZosXta1s5tuq9Ouu4Tukq30spnG5v//rumCQGDjVzI3Gb/neZo6GH2IE0kIECLKyEGisTMQOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCgY0Hbu+hqrf+/Ln6xvv79fbfby7bv5lH03IqeRLP7vSseuelBBT3eXnQtKI0ECyt6g6CjN92noB3iqHNBlg8dvUHQ0ZseoAR9uImi2bMHmUmBzOenl1H05AdVuLbvoujyXmVf7NrPt9HFQ/bpVqz3VOzmZhldf7qJZq+yD3OxVrmZIoAKqY3k0UWU31RME332fF1uugjtTP+CkijKc2dymS+RK4pV5B7elIuv1qn+Wuy2EKS5MWo1ZYB9gortmfSXxabL0CMKMuSCZClYZx9VQ6HL+Zd57m2hmpDr9TY23q4esn9Fqq/WcqWF2sGFTBu9ytdX2AH2VDEZJTHbe9CR9JdW6HAEiexc/lXZhbw5iHWhyv/SWtAqX/HzHzcygFguTOif1m7ZAfYJWqmIC/1DLik2VIZ2pndBeoluccyfUdVCuWvmc2Vft29MAFn6svxnKcgO0NRIqzQiSVGl9JdlaGf6b4Meb3Umf813Qe+vql0r89kWJI1evv28bBRkBzgoKI1qgqzQzgzRD3r86cY0qQ4lSJvYNAvyKUGmzuovrdDODNRR3L4uG4LmNkjtqyoYRSO9RxBqgwpBtgn1pRXamd4FiUx9p+qZOvDIzDcfxUwJulo/3jW3QU1HMf3REiSsiC7U47LYtBU6HEHZu7LvkYJ+UNEGHWyk7X6QLSg1HcVCUN4PKjb9TxnamQGq2EfZAj19yPJu80PeEf5RJxCLvn3YOYpd/iIPzk2CrACWIB3dFpQ9vhEHsmflpsvQznsUxuWOuH7aHw4jC4rVtQpROjwK/bCMLMh0VXzOjoZl7Cr2+HKen+sHytiCgoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgFMSVAziHzLTJyVo58OQGz0BKKiBnZo1ZF07CUG1/wctShTkuPGQoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYATEhTr+R0GfsT0dAQpP1+rx9JXeO3OOBlBm6WcqUg9wJ0M+Zz7CQlaZds7Nf9BWp27oN9roCcjSJWe5GAJ6jLHO9bDF7RZXrxXRShtaqU7FVT/EL6gYqaExokkJizIb14mGK4DAhOkZ+XxmJoJhWtNcIKyDhxNXZBW1GLC1YkLkk2w7Ooc3wucsiA54Zc2kx5fhCYsaLPs4gx0yoJeaD8tik92FoISCtqXi7g88eFhfn8uTAnqKFyXscIQFF44CnKNdUBQ/0PxdOjNclHMH3+KjXTvgoIMR0GusQIRJC/JJ1HLWWenLCiWbzC4zu9atA93fIjdYdH14KMIkrcsUnEuP/qphoOG0QTJG4Ojn2qEKkjUrc1SvkgFV7Ev88b7qlMWJDpC8j0OB/wUXaXm3tKUBTmQ6jPZMy1BLshKuE9Ql7eegxVkXtdwuJGO1espzrIExW6HryRanKcgNbbFhS/zJ2cqyHVMlKiL5yjo4AHeP1wHIQITpM4zOgzXPkRggoK5YBaqoGDCHSWov2uvExHU4fabspPpt1HG7UYITVlQOrtP5Nn82DcOQxUkB2fKsaunfT2oR0GyoygFnfYVxQFKUNzqqv2EBeVtUNKuuzhlQbqr2HIU1aQFBRKOglxDBCZIn4u1fcqpRQYb7xeGISjWjXPScqx9G0H1EEEJKh7fOXA51SNcm6RBCrKulo12bz5oQdYZ2GinGoELKirWwVONRD2rkDVrPHNBiWip9M17CtqHfqBXPetCQfswa4nz2aT7p54DFwTHbWSmBGXySBdsCer84rRXIKNF+AxVUAcZ2Z8tN8zFkO0dBQ0ejoIck1JQLYX7BBRnKqj+gYIaUlAQSEFBIAUFgRQUBFJQEEhBQSBFx4K6OmudrKDjc9SQv25wDtfqsbmzENT4gYKqK1IQWJGCwIoUBFakILAiBdVW6HSQS3CC4FOJWFB9xd4FtexRe6UrRg+lTcOIAhTkmrMGfNIVNw79p0vu+cpzIIKab1DX9j8Kmv4EOZSg6eHZBuVFqLENmh5+Bc4Mcjib8tN5P2h6DCBo3CZZ0Sb3nXnw28T+7XosbR3AEQoCUBCAggAUBKAgAAUBKAhAQQCeagAoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQoBdBaW0mKzUvmr7p6DYzSCWAfMH99b6wbgHylwtHK68cFPQhSE4lY78NOlV3YtWL6o8IkIrEarqHeliPHOgAHjko6UGQHuNQziKjZvj0eXliJYD+Jcnfwu02Oc3uquqB9qNmQOxBkJ6CqJx6ILl6LQUlzmW7EqD4s9fDeuRALFCWj5n5pw9BapeKP5f4VbVB8TeR4wsUKwHSi7+XKl0trEcOzHz97jmw6EGQrvymCZDFPVbNiLLkkr9KgEQOiJQTQFXDeuTATI/kkQOL3gVVZ/d0KgBVQbO8NLQQVDlieDZEfVcx9UspyGmKtEoA3ZKIdC2qmD39qu8kbX030knRC9HfuRxpKwH0bop0xzfSlSmgfY/1Axzm9V9QZ9qpAFQC6JGjaZvDfF5oPHJgMURHURdxlV+3JrISQDZiao+P7iiaTx45KOnlVCPRHf1i8kHdBsRlTfMKkJqDc+J+qlEJUNQ1jxwU8GQVQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKEKChd2bOBlQtHIUBBUs6OoF1jA0FBgPAEyYH1V/8tv5/roSqJGvyiFq6PGr/SkvAE5SVodq/Gb8p/cpSzKkFyBFTS8nXdvgQraKHGzOnhhenFe7XwxX3rN+V6E6yglfqgR88pU9pLOnQdC12QGSSrFoj26OJPlqDdEpQvVLWLVawiqDi6yw9qBG/KKiYbZiNIH7Ti2b1cKAvPZjnwLKkBChK9HdEPygWpfpAsOWLhWg3ujYc9zocoKCgoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA/5RIJ9naDN78AAAAAElFTkSuQmCC" /><!-- --></p>
<p>The value of estimated <span class="math inline">\(\theta\)</span> is 0.623.</p>
</div>
<div id="homework-7" class="section level2">
<h2>Homework 7</h2>
</div>
<div id="question-17" class="section level2">
<h2>Question</h2>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span>&lt; 1.2.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>We construct five chains with initial value 0.4,0.45,0.5,0.55,0.6, then we compute the Gelman-Rubin statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
<span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
<span class="co"># for chain in i-th row of X</span>
psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span>
B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span>
psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span>
W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span>
v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span>
r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span>
<span class="kw">return</span>(r.hat)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, grpsize) {
<span class="co"># computes (without the constant) the target density</span>
<span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)
<span class="kw">return</span> (<span class="dv">0</span>)
<span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">1</span>] <span class="op">*</span>
((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">3</span>] <span class="op">*</span>
(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>grpsize[<span class="dv">4</span>])
}

theta.chain&lt;-<span class="cf">function</span>(w,m,burn){ 
<span class="co">#generate the chain (w is the initial value; m is the length of the chain)</span>
x&lt;-<span class="kw">numeric</span>(m)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)        <span class="co">#for accept/reject step</span>
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="op">-</span>w, w) <span class="co">#proposal distribution</span>
x[<span class="dv">1</span>] &lt;-<span class="fl">0.5</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i]
<span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, grpsize) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], grpsize))
x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span>
x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}
<span class="kw">return</span>(x[(burn<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>m])
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">711</span>)
m &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chains</span>
burn &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span>
<span class="co">#choose overdispersed initial values</span>
grpsize&lt;-<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">20</span>,<span class="dv">18</span>,<span class="dv">34</span>)
x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.45</span>, <span class="fl">0.5</span>, <span class="fl">0.55</span>,<span class="fl">0.6</span>)
k&lt;-<span class="kw">length</span>(x0)  <span class="co">#number of chains to generate</span>
<span class="co">#generate the chains</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>m<span class="op">-</span>burn)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)
X[i, ] &lt;-<span class="st"> </span><span class="kw">theta.chain</span>(x0[i],m,burn)
<span class="kw">Gelman.Rubin</span>(X)</code></pre></div>
<pre><code>## [1] 1.001811</code></pre>
<p>The Gelman-Rubin statistic <span class="math inline">\(\hat{R}\)</span> is 1.001811&lt;1.2.</p>
</div>
<div id="question-18" class="section level2">
<h2>Question</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})
\]</span> and <span class="math display">\[
S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})
\]</span></p>
<p>for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz??ekely [260].)</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
res&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(K))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(K)){
  k&lt;-K[i]
  f&lt;-<span class="cf">function</span>(a)
  {<span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)}
  
  res[i]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="op">$</span>root
}
<span class="kw">cbind</span>(K,res)</code></pre></div>
<pre><code>##          K      res
##  [1,]    4 1.492103
##  [2,]    5 1.533556
##  [3,]    6 1.562744
##  [4,]    7 1.584430
##  [5,]    8 1.601185
##  [6,]    9 1.614521
##  [7,]   10 1.625390
##  [8,]   11 1.634419
##  [9,]   12 1.642038
## [10,]   13 1.648554
## [11,]   14 1.654190
## [12,]   15 1.659114
## [13,]   16 1.663452
## [14,]   17 1.667303
## [15,]   18 1.670745
## [16,]   19 1.673840
## [17,]   20 1.676637
## [18,]   21 1.679178
## [19,]   22 1.681496
## [20,]   23 1.683620
## [21,]   24 1.685572
## [22,]   25 1.687373
## [23,]  100 1.720608
## [24,]  500 1.729755
## [25,] 1000 1.730907</code></pre>
<p>The intersection points are established above.</p>
</div>
<div id="homework-8" class="section level2">
<h2>Homework 8</h2>
</div>
<div id="question-19" class="section level2">
<h2>Question</h2>
<p>Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[
\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},~~-\infty&lt;x&lt;\infty,
\]</span> where <span class="math inline">\(\theta&gt;0\)</span>. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>We use function “integrate” in R to compute the cdf of Cauchy distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f&lt;-<span class="cf">function</span>(x,eta,theta){      <span class="co">#density function</span>
  <span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
}
df&lt;-<span class="cf">function</span>(x,<span class="dt">eta=</span><span class="dv">0</span>,<span class="dt">theta=</span><span class="dv">1</span>){ <span class="co">#cdf of cauchy(eta,theta)</span>
    n&lt;-<span class="kw">length</span>(x)
    res&lt;-<span class="kw">numeric</span>(n)
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
     res[i]&lt;-<span class="kw">integrate</span>(f, <span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper=</span>x[i],
     <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,
     <span class="dt">theta=</span>theta,<span class="dt">eta=</span>eta)<span class="op">$</span>value
    }
     <span class="kw">return</span>(res)
}</code></pre></div>
<p>Next, we use “df” function builded myself and “pcauchy” function in R to construct the cdf figures with different parameters <span class="math inline">\(\theta, \eta\)</span> respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(1)       #standard Cauchy ditribution</span>
eta&lt;-<span class="dv">0</span>
theta&lt;-<span class="dv">1</span>
x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)
<span class="kw">plot</span>(x,<span class="kw">df</span>(x,eta,theta), <span class="dt">lwd =</span> <span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">&quot;cdf&quot;</span>,<span class="dt">main=</span><span class="st">&quot;cdf of Cauchy(eta=0, theta=1)&quot;</span>)
<span class="kw">curve</span>(<span class="kw">pcauchy</span>(x,<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">1</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(2)</span>
eta&lt;-<span class="dv">0</span>
theta&lt;-<span class="dv">5</span>
x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)
<span class="kw">plot</span>(x,<span class="kw">df</span>(x,eta,theta), <span class="dt">lwd =</span> <span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">&quot;cdf&quot;</span>,<span class="dt">main=</span><span class="st">&quot;cdf of Cauchy(eta=0, theta=5)&quot;</span>)
<span class="kw">curve</span>(<span class="kw">pcauchy</span>(x,<span class="dt">location =</span> <span class="dv">0</span>, <span class="dt">scale =</span> <span class="dv">5</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(3)</span>
eta&lt;-<span class="dv">5</span>
theta&lt;-<span class="dv">1</span>
x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">15</span>,<span class="fl">0.1</span>)
<span class="kw">plot</span>(x,<span class="kw">df</span>(x,eta,theta), <span class="dt">lwd =</span> <span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">&quot;cdf&quot;</span>,<span class="dt">main=</span><span class="st">&quot;cdf of Cauchy(eta=5, theta=1)&quot;</span>)
<span class="kw">curve</span>(<span class="kw">pcauchy</span>(x,<span class="dt">location =</span> <span class="dv">5</span>, <span class="dt">scale =</span> <span class="dv">1</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#(4)</span>
eta&lt;-<span class="dv">5</span>
theta&lt;-<span class="dv">5</span>
x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">15</span>,<span class="fl">0.1</span>)
<span class="kw">plot</span>(x,<span class="kw">df</span>(x,eta,theta), <span class="dt">lwd =</span> <span class="fl">0.5</span>,<span class="dt">ylab=</span><span class="st">&quot;cdf&quot;</span>,<span class="dt">main=</span><span class="st">&quot;cdf of Cauchy(eta=5, theta=5)&quot;</span>)
<span class="kw">curve</span>(<span class="kw">pcauchy</span>(x,<span class="dt">location =</span> <span class="dv">5</span>, <span class="dt">scale =</span> <span class="dv">5</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As the figures showing, the cdf computed by myself is much close to the results from “pcauchy”.</p>
<p>Finally, we establish the the source code in pcauchy.c.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pcauchy</code></pre></div>
<pre><code>## function (q, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE) 
## .Call(C_pcauchy, q, location, scale, lower.tail, log.p)
## &lt;bytecode: 0x0000000021be0460&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
</div>
<div id="question-20" class="section level2">
<h2>Question</h2>
<p>A-B-O blood type problem</p>
<p><span class="math inline">\(\blacktriangleright\)</span> Let the three alleles be A, B, and O.</p>
<p>Genotype AA <span class="math inline">\(~~\)</span> BB <span class="math inline">\(~~\)</span> OO <span class="math inline">\(~~\)</span> AO <span class="math inline">\(~~\)</span> BO <span class="math inline">\(~~\)</span> AB</p>
<p>Frequency p2 <span class="math inline">\(~~\)</span> q2 <span class="math inline">\(~~\)</span> r2 <span class="math inline">\(~~\)</span> 2pr <span class="math inline">\(~~\)</span> 2qr <span class="math inline">\(~~\)</span> 2pq <span class="math inline">\(~~\)</span> 1</p>
<p>Count <span class="math inline">\(~~~~~n_{AA}\)</span> <span class="math inline">\(n_{BB}\)</span> <span class="math inline">\(n_{OO}\)</span> <span class="math inline">\(n_{AO}\)</span> <span class="math inline">\(n_{BO}\)</span> <span class="math inline">\(n_{AB}~~\)</span> n</p>
<p><span class="math inline">\(\blacktriangleright\)</span> Observed data: <span class="math inline">\(n_{A??} = n_{AA} + n_{AO} = 28 ~~~(A-type),\)</span></p>
<p><span class="math inline">\(n_{B??} = n_{BB} + n_{BO} = 24 ~~(B-type), n_{OO} = 41~~ (O-type), n_{AB} = 70 ~~(AB-type).\)</span></p>
<p><span class="math inline">\(\blacktriangleright\)</span> Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA} and n_{BB}\)</span>).</p>
<p><span class="math inline">\(\blacktriangleright\)</span> Record the maximum likelihood values in M-steps, are they increasing?</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>First, we show you the complete data likelihood and with the initial parameters <span class="math inline">\(\hat{p}_0,~\hat{q}_0\)</span> we give you the fomulation of one step MLES.</p>
<p>Complete data likelihood: <span class="math display">\[
L(p,q|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}},
\]</span> <span class="math display">\[
l(p,q|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=n_{A\cdot}log(pr)+n_{AA}log(p/r)+n_{B\cdot}log(qr)+n_{BB}log(q/r)+2n_{OO}log(r)+n_{AB}log(pq),
\]</span> <span class="math display">\[
E_{(\hat{p}_0,\hat{q}_0)}[l(p,q|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})]=n_{A\cdot}log(pr)+n_{A\cdot}\frac{\hat{p}_0}{2-\hat{p}_0-2\hat{q}_0}log(p/r)+n_{B\cdot}log(qr)+n_{B\cdot}\frac{\hat{q}_0}{2-2\hat{p}_0-\hat{q}_0}log(q/r)+2n_{OO}log(r)+n_{AB}log(pq),
\]</span> where <span class="math inline">\(\hat{p}_0\)</span> and <span class="math inline">\(\hat{q}_0\)</span> are two initial parameters.</p>
<p>Define <span class="math inline">\(a_0=\frac{\hat{p}_0}{2-\hat{p}_0-2\hat{q}_0}\)</span> and <span class="math inline">\(b_0=\frac{\hat{q}_0}{2-2\hat{p}_0-\hat{q}_0}\)</span>, we can simplify the expectation equation: <span class="math display">\[
E_{(\hat{p}_0,\hat{q}_0)}[l(p,q|n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})]=[n_{A\cdot}(1+a_0)+n_{AB}]log(p)+[n_{A\cdot}(1-a_0)+n_{B\cdot}(1-b_0)+2n_{OO}]log(r)+[n_{B\cdot}(1+b_0)+n_{AB}]log(q).
\]</span> Then maximize the expectation equation, we obtain MLEs <span class="math inline">\(\hat{p}_1,~\hat{q}_1\)</span>: <span class="math display">\[
\hat{p}_1=\frac{H_p}{H_p+H_q+H_{pq}},~~\hat{q}_1=\frac{H_q}{H_p+H_q+H_{pq}},
\]</span> where <span class="math inline">\(H_p=n_{A\cdot}(1+a_0)+n_{AB}\)</span>, <span class="math inline">\(H_1=n_{B\cdot}(1+b_0)+n_{AB}\)</span> and <span class="math inline">\(H_{pq}=n_{A\cdot}(1-a_0)+n_{B\cdot}(1-b_0)+2n_{OO}\)</span>.</p>
<p>Next, we use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p0&lt;-<span class="fl">0.2</span>; q0&lt;-<span class="fl">0.2</span>   <span class="co">#initial estimates</span>
nA&lt;-<span class="dv">28</span>; nB&lt;-<span class="dv">24</span>; nOO&lt;-<span class="dv">41</span>; nAB&lt;-<span class="dv">70</span>  <span class="co">#observed data</span>
tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span>
N &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#max. number of iterations</span>
p&lt;-p0; q&lt;-q0
El&lt;-<span class="kw">numeric</span>(N) <span class="co">#Record the maximum likelihood values in M-steps</span>
k&lt;-<span class="dv">1</span>  <span class="co">#Record the circle times</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {
a&lt;-p<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p<span class="op">-</span><span class="dv">2</span><span class="op">*</span>q)
b&lt;-q<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>p<span class="op">-</span>q)
Hp=nA<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>a)<span class="op">+</span>nAB
Hq=nB<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>b)<span class="op">+</span>nAB
Hpq=nA<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>b)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO

El[i]&lt;-Hp<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span>Hpq<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>Hq<span class="op">*</span><span class="kw">log</span>(q) <span class="co">#Record the    maximum likelihood values in M-steps</span>

x&lt;-p; y&lt;-q                <span class="co">#storage previous estimates</span>
p&lt;-Hp<span class="op">/</span>(Hp<span class="op">+</span>Hq<span class="op">+</span>Hpq); q&lt;-Hq<span class="op">/</span>(Hp<span class="op">+</span>Hq<span class="op">+</span>Hpq)
k&lt;-k<span class="op">+</span><span class="dv">1</span>
<span class="cf">if</span> (<span class="kw">abs</span>(p<span class="op">-</span>x)<span class="op">/</span>x<span class="op">&lt;</span>tol <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">abs</span>(q<span class="op">-</span>y)<span class="op">/</span>y<span class="op">&lt;</span>tol) <span class="cf">break</span>
p.hat&lt;-p; q.hat&lt;-q
El&lt;-El[<span class="dv">1</span><span class="op">:</span>k]
}
p.hat</code></pre></div>
<pre><code>## [1] 0.3273442</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q.hat</code></pre></div>
<pre><code>## [1] 0.3104267</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">El        </code></pre></div>
<pre><code>##  [1] -385.6238 -357.6570 -357.4552 -357.4672 -357.4698 -357.4702 -357.4703
##  [8] -357.4703 -357.4703 -357.4703</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diff</span>(El)  <span class="co">#First order difference of maximum likelihood values in M-steps</span></code></pre></div>
<pre><code>## [1]  2.796683e+01  2.017960e-01 -1.202888e-02 -2.597987e-03 -3.994175e-04
## [6] -5.906359e-05 -8.685763e-06 -1.276277e-06 -1.875125e-07</code></pre>
<p>By EM algorithm, we obtain MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> are 0.3273442 and 0.3104267. From the First order difference of maximum log-likelihood values, they are not increasing.</p>
</div>
<div id="homework-9" class="section level2">
<h2>Homework 9</h2>
</div>
<div id="question-21" class="section level2">
<h2>Question</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use for loops</span>
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
mpg <span class="op">~</span><span class="st"> </span>disp,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)
f&lt;-<span class="kw">list</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  f[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]],mtcars)
}
f</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use lapply()</span>
<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-22" class="section level2">
<h2>Question</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) {</p>
<p>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use for loops</span>
<span class="kw">set.seed</span>(<span class="dv">921</span>)
<span class="kw">attach</span>(mtcars)</code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 3):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
mtcars[rows, ]
})
f&lt;-<span class="kw">list</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  f[[i]]&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,bootstraps[[i]])
}
f</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.99855     -0.04427  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59057     -0.04108  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.96672     -0.03787  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.23578     -0.04426  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.60906     -0.04166  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.70258     -0.03964  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      27.769       -0.034  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.51000     -0.03824  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.06571     -0.03995  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92603     -0.04125</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use lapply()</span>
<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(x) <span class="kw">lm</span>(mpg<span class="op">~</span>disp,x))</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.99855     -0.04427  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59057     -0.04108  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.96672     -0.03787  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.23578     -0.04426  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.60906     -0.04166  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.70258     -0.03964  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##      27.769       -0.034  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.51000     -0.03824  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.06571     -0.03995  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.92603     -0.04125</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Without an anonymous function</span>
<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.99855     -0.04427  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59057     -0.04108  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.96672     -0.03787  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.23578     -0.04426  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.60906     -0.04166  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.70258     -0.03964  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      27.769       -0.034  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.51000     -0.03824  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.06571     -0.03995  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92603     -0.04125</code></pre>
</div>
<div id="question-23" class="section level2">
<h2>Question</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>In this exercise, we only use lapply() to extract <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">921</span>)
mod1&lt;-<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(x) <span class="kw">lm</span>(x,mtcars))
mod2&lt;-<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(x) <span class="kw">lm</span>(mpg<span class="op">~</span>disp,x))

rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared
<span class="kw">c</span>(<span class="kw">unlist</span>(<span class="kw">lapply</span>(mod1,rsq)),<span class="kw">unlist</span>(<span class="kw">lapply</span>(mod2,rsq)))</code></pre></div>
<pre><code>##  [1] 0.7183433 0.8596865 0.7809306 0.8838038 0.6635125 0.6236858 0.6840406
##  [8] 0.7287437 0.7241064 0.7977047 0.6733847 0.8084300 0.7536369 0.8678606</code></pre>
</div>
<div id="question-24" class="section level2">
<h2>Question</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Use sapply() and an anonymous function</span>
<span class="kw">set.seed</span>(<span class="dv">941</span>)
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
<span class="dv">100</span>,
<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
<span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
<span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</code></pre></div>
<pre><code>##   [1] 0.762327836 0.432405754 0.849422922 0.025173259 0.589780005
##   [6] 0.534129784 0.343657986 0.740800686 0.319856145 0.251585163
##  [11] 0.761305726 0.553239979 0.136294169 0.842363559 0.807221166
##  [16] 0.329770867 0.385760898 0.862108036 0.677594188 0.773167883
##  [21] 0.057440950 0.186036878 0.612379623 0.207390349 0.993142825
##  [26] 0.456448353 0.321307783 0.810431278 0.139963831 0.003659927
##  [31] 0.224796134 0.882284597 0.037057339 0.752195613 0.895089495
##  [36] 0.621895081 0.006155467 0.297371298 0.563376097 0.871466309
##  [41] 0.239761830 0.093166143 0.273797812 0.603885306 0.487956426
##  [46] 0.883541984 0.338101783 0.038457494 0.247006741 0.455943303
##  [51] 0.782226917 0.507269224 0.850947550 0.089839800 0.035916615
##  [56] 0.063840518 0.019041518 0.883140448 0.728671831 0.313702812
##  [61] 0.098397080 0.291238850 0.293536941 0.754109218 0.524056806
##  [66] 0.281562502 0.959719088 0.979798696 0.168910702 0.787139835
##  [71] 0.563633078 0.482450195 0.769576909 0.523804659 0.011020401
##  [76] 0.627432979 0.993366016 0.787366697 0.787015778 0.015490389
##  [81] 0.977668623 0.668426919 0.184185074 0.927035195 0.219562523
##  [86] 0.672217808 0.508872556 0.988442766 0.680671987 0.044828398
##  [91] 0.850378273 0.684658850 0.123014326 0.202469769 0.263958542
##  [96] 0.169781152 0.273767019 0.094366417 0.313135907 0.671372315</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Without an anonymous function</span>
p.value&lt;-<span class="cf">function</span>(x) x<span class="op">$</span>p.value  <span class="co">#define p.value function</span>
<span class="kw">sapply</span>(trials,p.value)</code></pre></div>
<pre><code>##   [1] 0.762327836 0.432405754 0.849422922 0.025173259 0.589780005
##   [6] 0.534129784 0.343657986 0.740800686 0.319856145 0.251585163
##  [11] 0.761305726 0.553239979 0.136294169 0.842363559 0.807221166
##  [16] 0.329770867 0.385760898 0.862108036 0.677594188 0.773167883
##  [21] 0.057440950 0.186036878 0.612379623 0.207390349 0.993142825
##  [26] 0.456448353 0.321307783 0.810431278 0.139963831 0.003659927
##  [31] 0.224796134 0.882284597 0.037057339 0.752195613 0.895089495
##  [36] 0.621895081 0.006155467 0.297371298 0.563376097 0.871466309
##  [41] 0.239761830 0.093166143 0.273797812 0.603885306 0.487956426
##  [46] 0.883541984 0.338101783 0.038457494 0.247006741 0.455943303
##  [51] 0.782226917 0.507269224 0.850947550 0.089839800 0.035916615
##  [56] 0.063840518 0.019041518 0.883140448 0.728671831 0.313702812
##  [61] 0.098397080 0.291238850 0.293536941 0.754109218 0.524056806
##  [66] 0.281562502 0.959719088 0.979798696 0.168910702 0.787139835
##  [71] 0.563633078 0.482450195 0.769576909 0.523804659 0.011020401
##  [76] 0.627432979 0.993366016 0.787366697 0.787015778 0.015490389
##  [81] 0.977668623 0.668426919 0.184185074 0.927035195 0.219562523
##  [86] 0.672217808 0.508872556 0.988442766 0.680671987 0.044828398
##  [91] 0.850378273 0.684658850 0.123014326 0.202469769 0.263958542
##  [96] 0.169781152 0.273767019 0.094366417 0.313135907 0.671372315</code></pre>
</div>
<div id="question-25" class="section level2">
<h2>Question</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>We combine Map() and vapply() to create an lapply() variant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lapply1&lt;-<span class="cf">function</span> (f,n,type, ...) {  <span class="co">#n is the length of output of function f.</span>
  f &lt;-<span class="st"> </span><span class="kw">match.fun</span>(f)
  tt=<span class="kw">Map</span>(f, ...)
  <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;numeric&quot;</span>)  y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">numeric</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;character&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">character</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;complex&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">complex</span>(n))
  <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;logical&quot;</span>) y=<span class="kw">vapply</span>(tt,cbind,<span class="kw">logical</span>(n))
  <span class="kw">return</span>(y)
}
<span class="co">#example</span>
<span class="kw">set.seed</span>(<span class="dv">951</span>)
kk&lt;-<span class="cf">function</span>(x,w){
  y=<span class="kw">weighted.mean</span>(x, w, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  <span class="kw">return</span>(<span class="kw">c</span>(<span class="dv">1</span>,y))
}
xs &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)
ws &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">5</span>, <span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)
<span class="kw">lapply1</span>(kk,<span class="dv">2</span>,<span class="st">&quot;numeric&quot;</span>,xs, ws)</code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000
## [2,] 0.4014124 0.4455721 0.4782084 0.5351192 0.4263513</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.matrix</span>(<span class="kw">lapply1</span>(kk,<span class="dv">2</span>,<span class="st">&quot;numeric&quot;</span>,xs, ws))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Then, we use function “foreach” to create an lapply() variant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(foreach)
lapply2&lt;-<span class="cf">function</span>(...,combine){
<span class="kw">foreach</span>(...,<span class="dt">.combine=</span>combine)
}</code></pre></div>
<p>We use the new function to complete some simple Parallel computations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#output is vector</span>
<span class="kw">lapply2</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">b=</span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">combine=</span><span class="st">&quot;c&quot;</span>)<span class="op">%do%</span>{x1&lt;-a<span class="op">+</span>b;x2&lt;-a<span class="op">*</span>b;<span class="kw">c</span>(x1,x2)}</code></pre></div>
<pre><code>## [1] 2 1 3 2 4 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#output is matrix</span>
<span class="kw">lapply2</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">b=</span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="dt">combine=</span><span class="st">&quot;cbind&quot;</span>)<span class="op">%do%</span>{x1&lt;-a<span class="op">+</span>b;x2&lt;-a<span class="op">*</span>b;<span class="kw">c</span>(x1,x2)}</code></pre></div>
<pre><code>##      result.1 result.2 result.3
## [1,]        2        3        4
## [2,]        1        2        3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Obtain same results in the former question with the new function</span>
<span class="kw">lapply2</span>(<span class="dt">i=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(trials),<span class="dt">combine=</span>c)<span class="op">%do%</span>trials[[i]]<span class="op">$</span>p.value</code></pre></div>
<pre><code>##   [1] 0.762327836 0.432405754 0.849422922 0.025173259 0.589780005
##   [6] 0.534129784 0.343657986 0.740800686 0.319856145 0.251585163
##  [11] 0.761305726 0.553239979 0.136294169 0.842363559 0.807221166
##  [16] 0.329770867 0.385760898 0.862108036 0.677594188 0.773167883
##  [21] 0.057440950 0.186036878 0.612379623 0.207390349 0.993142825
##  [26] 0.456448353 0.321307783 0.810431278 0.139963831 0.003659927
##  [31] 0.224796134 0.882284597 0.037057339 0.752195613 0.895089495
##  [36] 0.621895081 0.006155467 0.297371298 0.563376097 0.871466309
##  [41] 0.239761830 0.093166143 0.273797812 0.603885306 0.487956426
##  [46] 0.883541984 0.338101783 0.038457494 0.247006741 0.455943303
##  [51] 0.782226917 0.507269224 0.850947550 0.089839800 0.035916615
##  [56] 0.063840518 0.019041518 0.883140448 0.728671831 0.313702812
##  [61] 0.098397080 0.291238850 0.293536941 0.754109218 0.524056806
##  [66] 0.281562502 0.959719088 0.979798696 0.168910702 0.787139835
##  [71] 0.563633078 0.482450195 0.769576909 0.523804659 0.011020401
##  [76] 0.627432979 0.993366016 0.787366697 0.787015778 0.015490389
##  [81] 0.977668623 0.668426919 0.184185074 0.927035195 0.219562523
##  [86] 0.672217808 0.508872556 0.988442766 0.680671987 0.044828398
##  [91] 0.850378273 0.684658850 0.123014326 0.202469769 0.263958542
##  [96] 0.169781152 0.273767019 0.094366417 0.313135907 0.671372315</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bias&lt;-<span class="kw">lapply2</span>(<span class="dt">i=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(trials),<span class="dt">combine=</span>c)<span class="op">%do%</span>trials[[i]]<span class="op">$</span>p.value<span class="op">-</span><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)
bias</code></pre></div>
<pre><code>##   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [36] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [71] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<div id="homework-10" class="section level2">
<h2>Homework 10</h2>
</div>
<div id="question-26" class="section level2">
<h2>Question</h2>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1011</span>)
chisq.test2&lt;-<span class="cf">function</span>(x,y){
  input&lt;-<span class="kw">as.table</span>(<span class="kw">rbind</span>(x,y))
  out&lt;-<span class="kw">chisq.test</span>(input)<span class="op">$</span>statistic
  out
}

<span class="co">#Example</span>
x&lt;-<span class="kw">rpois</span>(<span class="dv">10000</span>,<span class="dt">lambda=</span><span class="dv">20</span>)

y&lt;-<span class="kw">rbinom</span>(<span class="dv">10000</span>,<span class="dv">30</span>,<span class="fl">0.6</span>)

<span class="kw">chisq.test2</span>(x,y)</code></pre></div>
<pre><code>## X-squared 
##  6777.921</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">chisq.test2</span>(x,y))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.02    0.00    0.01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">chisq.test</span>((<span class="kw">as.table</span>(<span class="kw">rbind</span>(x,y)))))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.01    0.00    0.02</code></pre>
</div>
<div id="question-27" class="section level2">
<h2>Question</h2>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1011</span>)
x&lt;-<span class="kw">rpois</span>(<span class="dv">10000</span>,<span class="dt">lambda=</span><span class="dv">20</span>)
y&lt;-<span class="kw">rbinom</span>(<span class="dv">10000</span>,<span class="dv">30</span>,<span class="fl">0.6</span>)
as.table2&lt;-<span class="cf">function</span>(x,y){
  out&lt;-<span class="kw">rbind</span>(x,y)
  <span class="kw">class</span>(out)&lt;-<span class="st">&quot;table&quot;</span>
  out
}
<span class="kw">class</span>(<span class="kw">as.table2</span>(x,y))</code></pre></div>
<pre><code>## [1] &quot;table&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">as.table2</span>(x,y))</code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">as.table</span>(<span class="kw">rbind</span>(x,y)))</code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">chisq.test</span>(<span class="kw">as.table2</span>(x,y)))</code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">chisq.test</span>(<span class="kw">as.table</span>(<span class="kw">rbind</span>(x,y))))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.01    0.00    0.02</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
